{"title":"冰球 背景","slug":"hexo/Icosahedron-Geometry-hexo","date":"2021-07-21T07:20:55.000Z","updated":"2022-09-04T13:19:43.241Z","comments":true,"path":"api/articles/hexo/Icosahedron-Geometry-hexo.json","excerpt":null,"covers":["https://image.wxydejoy.top/img/202107/21/142359%20%E5%8A%A8%E7%94%BB2142.gif"],"content":"<p>%%% tip home %%%-</p>\n<p>首先感谢大佬的开源项目</p>\n<p>%%% ghcard teachtyler&#x2F;Icosahedron-Geometry %%%-</p>\n<p>还有店长的教程<a href=\"https://akilar.top/posts/23fdf850/\">糖果屋微调合集 | Akilar の糖果屋</a> <a href=\"https://akilar.top/posts/ebf20e02/\">Custom Beautify | Akilar の糖果屋</a></p>\n<p>%%% span red, 未实现：冰球跟随音乐振动 %%%-</p>\n<p>希望有大佬来解决这个问题，我这个小菜鸡实在搞不定。</p>\n<p>有建议请评论区留言，欢迎！！</p>\n<p>7.27 更新：关闭移动端并根据屏幕大小判断是否引入并开启</p>\n<p>%%% endtip %%%-</p>\n<h2 id=\"最终效果\"><a href=\"#最终效果\" class=\"headerlink\" title=\"最终效果\"></a>最终效果</h2><p><img src=\"https://image.wxydejoy.top/img/202107/21/142359%20%E5%8A%A8%E7%94%BB2142.gif\" alt=\"动画2142\"></p>\n<h2 id=\"引入-js\"><a href=\"#引入-js\" class=\"headerlink\" title=\"引入 js\"></a>引入 js</h2><p>只针对 butterfly 主题，其他主题请自己根据情况调整</p>\n<p>icebg.js 代码在最下面</p>\n<p>在<code>_config.butterfly.yml</code>中<code>inject</code>的<code>bottom:</code>插入代码</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-(<span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">data-pjax</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;你自己icebg.js的地址&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span>);</span><br></pre></td></tr></table></figure>\n\n<p>建议修改合适后再通过 jsd 加速插入，因为每个人需求不一样，如果你想要本站一样的效果就改成这样,如果需要自定义请接着看。</p>\n<p>当然，建议读者把代码存到自己仓库</p>\n<p>如果只需要当背景，而不是头图，到这里就够了，如果想要跟本站一样，参考店长头图透明教程在<code>costom.css</code>文件中加入</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/* 头图透明 */</span></span><br><span class=\"line\"><span class=\"selector-id\">#page-header</span>&#123;</span><br><span class=\"line\">  <span class=\"attribute\">background</span>: transparent<span class=\"meta\">!important</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>注意：因为 butterfly 版本迭代，店长教程中的配置手机 PC 页面白天黑夜共四个背景图的第一步请按<code>diff代码</code>块配置。<del>因为我就掉坑了</del></p>\n<p>店长教程点这里<a href=\"https://akilar.top/posts/ebf20e02/\">Custom Beautify | Akilar の糖果屋</a>,建议配合<a href=\"https://akilar.top/posts/23fdf850/\">糖果屋微调合集 | Akilar の糖果屋</a>配置手机 PC 页面白天黑夜共四个背景图食用，效果更佳。</p>\n<p>然后</p>\n<p>然后就没了，就这，对，就这。</p>\n<h2 id=\"自定义\"><a href=\"#自定义\" class=\"headerlink\" title=\"自定义\"></a>自定义</h2><p>建议有一定基础的朋友进行自定义修改，比如把球改到侧边栏</p>\n<p>icebg.js 我放在了<code>source</code>博客根目录，方便调试，读者可以根据情况修改。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-(<span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">data-pjax</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;/icebg.js&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span>);</span><br></pre></td></tr></table></figure>\n\n<p>自定义只需要修改<code>icebg.js</code>内的代码就可以了，代码还是挺长的，其他的我也不会了，大家看着办吧，有大佬改记得评论区告诉我一下。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br><span class=\"line\">259</span><br><span class=\"line\">260</span><br><span class=\"line\">261</span><br><span class=\"line\">262</span><br><span class=\"line\">263</span><br><span class=\"line\">264</span><br><span class=\"line\">265</span><br><span class=\"line\">266</span><br><span class=\"line\">267</span><br><span class=\"line\">268</span><br><span class=\"line\">269</span><br><span class=\"line\">270</span><br><span class=\"line\">271</span><br><span class=\"line\">272</span><br><span class=\"line\">273</span><br><span class=\"line\">274</span><br><span class=\"line\">275</span><br><span class=\"line\">276</span><br><span class=\"line\">277</span><br><span class=\"line\">278</span><br><span class=\"line\">279</span><br><span class=\"line\">280</span><br><span class=\"line\">281</span><br><span class=\"line\">282</span><br><span class=\"line\">283</span><br><span class=\"line\">284</span><br><span class=\"line\">285</span><br><span class=\"line\">286</span><br><span class=\"line\">287</span><br><span class=\"line\">288</span><br><span class=\"line\">289</span><br><span class=\"line\">290</span><br><span class=\"line\">291</span><br><span class=\"line\">292</span><br><span class=\"line\">293</span><br><span class=\"line\">294</span><br><span class=\"line\">295</span><br><span class=\"line\">296</span><br><span class=\"line\">297</span><br><span class=\"line\">298</span><br><span class=\"line\">299</span><br><span class=\"line\">300</span><br><span class=\"line\">301</span><br><span class=\"line\">302</span><br><span class=\"line\">303</span><br><span class=\"line\">304</span><br><span class=\"line\">305</span><br><span class=\"line\">306</span><br><span class=\"line\">307</span><br><span class=\"line\">308</span><br><span class=\"line\">309</span><br><span class=\"line\">310</span><br><span class=\"line\">311</span><br><span class=\"line\">312</span><br><span class=\"line\">313</span><br><span class=\"line\">314</span><br><span class=\"line\">315</span><br><span class=\"line\">316</span><br><span class=\"line\">317</span><br><span class=\"line\">318</span><br><span class=\"line\">319</span><br><span class=\"line\">320</span><br><span class=\"line\">321</span><br><span class=\"line\">322</span><br><span class=\"line\">323</span><br><span class=\"line\">324</span><br><span class=\"line\">325</span><br><span class=\"line\">326</span><br><span class=\"line\">327</span><br><span class=\"line\">328</span><br><span class=\"line\">329</span><br><span class=\"line\">330</span><br><span class=\"line\">331</span><br><span class=\"line\">332</span><br><span class=\"line\">333</span><br><span class=\"line\">334</span><br><span class=\"line\">335</span><br><span class=\"line\">336</span><br><span class=\"line\">337</span><br><span class=\"line\">338</span><br><span class=\"line\">339</span><br><span class=\"line\">340</span><br><span class=\"line\">341</span><br><span class=\"line\">342</span><br><span class=\"line\">343</span><br><span class=\"line\">344</span><br><span class=\"line\">345</span><br><span class=\"line\">346</span><br><span class=\"line\">347</span><br><span class=\"line\">348</span><br><span class=\"line\">349</span><br><span class=\"line\">350</span><br><span class=\"line\">351</span><br><span class=\"line\">352</span><br><span class=\"line\">353</span><br><span class=\"line\">354</span><br><span class=\"line\">355</span><br><span class=\"line\">356</span><br><span class=\"line\">357</span><br><span class=\"line\">358</span><br><span class=\"line\">359</span><br><span class=\"line\">360</span><br><span class=\"line\">361</span><br><span class=\"line\">362</span><br><span class=\"line\">363</span><br><span class=\"line\">364</span><br><span class=\"line\">365</span><br><span class=\"line\">366</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// document.write(&quot;&lt;script  src=&#x27;https://cdn.jsdelivr.net/gh/wxydejoy/wxy_bg@main/vendor/simplex-noise.min.js&#x27;&gt;&lt;/script&gt;&quot;);</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> renderer,</span><br><span class=\"line\">  scene,</span><br><span class=\"line\">  camera,</span><br><span class=\"line\">  composer,</span><br><span class=\"line\">  lights,</span><br><span class=\"line\">  circle,</span><br><span class=\"line\">  skelet,</span><br><span class=\"line\">  particle,</span><br><span class=\"line\">  planet,</span><br><span class=\"line\">  planet2,</span><br><span class=\"line\">  audioArray,</span><br><span class=\"line\">  user_audio_amp,</span><br><span class=\"line\">  audio_wireframe = <span class=\"literal\">true</span>,</span><br><span class=\"line\">  primaryColor = <span class=\"literal\">null</span>,</span><br><span class=\"line\">  secondaryColor = <span class=\"literal\">null</span>,</span><br><span class=\"line\">  thirdColor = <span class=\"literal\">null</span>,</span><br><span class=\"line\">  bg_file,</span><br><span class=\"line\">  move_bg,</span><br><span class=\"line\">  bass_wireframe;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">loadScript</span>(<span class=\"params\">src, callback</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> script = <span class=\"variable language_\">document</span>.<span class=\"title function_\">createElement</span>(<span class=\"string\">&quot;script&quot;</span>),</span><br><span class=\"line\">    head = <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementsByTagName</span>(<span class=\"string\">&quot;head&quot;</span>)[<span class=\"number\">0</span>];</span><br><span class=\"line\">  script.<span class=\"property\">type</span> = <span class=\"string\">&quot;text/javascript&quot;</span>;</span><br><span class=\"line\">  script.<span class=\"property\">charset</span> = <span class=\"string\">&quot;UTF-8&quot;</span>;</span><br><span class=\"line\">  script.<span class=\"property\">src</span> = src;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (script.<span class=\"property\">addEventListener</span>) &#123;</span><br><span class=\"line\">    script.<span class=\"title function_\">addEventListener</span>(</span><br><span class=\"line\">      <span class=\"string\">&quot;load&quot;</span>,</span><br><span class=\"line\">      <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">        <span class=\"title function_\">callback</span>();</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"literal\">false</span></span><br><span class=\"line\">    );</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (script.<span class=\"property\">attachEvent</span>) &#123;</span><br><span class=\"line\">    script.<span class=\"title function_\">attachEvent</span>(<span class=\"string\">&quot;onreadystatechange&quot;</span>, <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">var</span> target = <span class=\"variable language_\">window</span>.<span class=\"property\">event</span>.<span class=\"property\">srcElement</span>;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (target.<span class=\"property\">readyState</span> == <span class=\"string\">&quot;loaded&quot;</span>) &#123;</span><br><span class=\"line\">        <span class=\"title function_\">callback</span>();</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  head.<span class=\"title function_\">appendChild</span>(script);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">loadlived</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"variable language_\">document</span>.<span class=\"property\">body</span>.<span class=\"property\">clientWidth</span> &gt; <span class=\"number\">900</span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">document</span>.<span class=\"property\">onreadystatechange</span> = <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable language_\">document</span>.<span class=\"property\">readyState</span> == <span class=\"string\">&quot;complete&quot;</span>) &#123;</span><br><span class=\"line\">        <span class=\"title function_\">loadScript</span>(</span><br><span class=\"line\">          <span class=\"string\">&quot;https://cdn.jsdelivr.net/gh/wxydejoy/wxy_bg@main/vendor/simplex-noise.min.js&quot;</span>,</span><br><span class=\"line\">          <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\">        );</span><br><span class=\"line\">        <span class=\"title function_\">loadScript</span>(</span><br><span class=\"line\">          <span class=\"string\">&quot;https://cdn.jsdelivr.net/gh/wxydejoy/wxy_bg@main/vendor/three.min.js&quot;</span>,</span><br><span class=\"line\">          <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">            <span class=\"title function_\">init</span>();</span><br><span class=\"line\">            <span class=\"title function_\">animate</span>();</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        );</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"title function_\">loadlived</span>();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// if (document.body.clientWidth &gt; 768) &#123;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//     init();</span></span><br><span class=\"line\"><span class=\"comment\">//     animate();</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// &#125;;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// document.write(&quot;&lt;script  src=&#x27;https://cdn.jsdelivr.net/gh/wxydejoy/wxy_bg@main/vendor/simplex-noise.min.js&#x27;&gt;&lt;/script&gt;&quot;);</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> renderer,</span><br><span class=\"line\">  scene,</span><br><span class=\"line\">  camera,</span><br><span class=\"line\">  composer,</span><br><span class=\"line\">  lights,</span><br><span class=\"line\">  circle,</span><br><span class=\"line\">  skelet,</span><br><span class=\"line\">  particle,</span><br><span class=\"line\">  planet,</span><br><span class=\"line\">  planet2,</span><br><span class=\"line\">  audioArray,</span><br><span class=\"line\">  user_audio_amp,</span><br><span class=\"line\">  audio_wireframe = <span class=\"literal\">true</span>,</span><br><span class=\"line\">  primaryColor = <span class=\"literal\">null</span>,</span><br><span class=\"line\">  secondaryColor = <span class=\"literal\">null</span>,</span><br><span class=\"line\">  thirdColor = <span class=\"literal\">null</span>,</span><br><span class=\"line\">  bg_file,</span><br><span class=\"line\">  move_bg,</span><br><span class=\"line\">  bass_wireframe;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">loadScript</span>(<span class=\"params\">src, callback</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> script = <span class=\"variable language_\">document</span>.<span class=\"title function_\">createElement</span>(<span class=\"string\">&quot;script&quot;</span>),</span><br><span class=\"line\">    head = <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementsByTagName</span>(<span class=\"string\">&quot;head&quot;</span>)[<span class=\"number\">0</span>];</span><br><span class=\"line\">  script.<span class=\"property\">type</span> = <span class=\"string\">&quot;text/javascript&quot;</span>;</span><br><span class=\"line\">  script.<span class=\"property\">charset</span> = <span class=\"string\">&quot;UTF-8&quot;</span>;</span><br><span class=\"line\">  script.<span class=\"property\">src</span> = src;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (script.<span class=\"property\">addEventListener</span>) &#123;</span><br><span class=\"line\">    script.<span class=\"title function_\">addEventListener</span>(</span><br><span class=\"line\">      <span class=\"string\">&quot;load&quot;</span>,</span><br><span class=\"line\">      <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">        <span class=\"title function_\">callback</span>();</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"literal\">false</span></span><br><span class=\"line\">    );</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (script.<span class=\"property\">attachEvent</span>) &#123;</span><br><span class=\"line\">    script.<span class=\"title function_\">attachEvent</span>(<span class=\"string\">&quot;onreadystatechange&quot;</span>, <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">var</span> target = <span class=\"variable language_\">window</span>.<span class=\"property\">event</span>.<span class=\"property\">srcElement</span>;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (target.<span class=\"property\">readyState</span> == <span class=\"string\">&quot;loaded&quot;</span>) &#123;</span><br><span class=\"line\">        <span class=\"title function_\">callback</span>();</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  head.<span class=\"title function_\">appendChild</span>(script);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">loadlived</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"variable language_\">document</span>.<span class=\"property\">body</span>.<span class=\"property\">clientWidth</span> &gt; <span class=\"number\">900</span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">document</span>.<span class=\"property\">onreadystatechange</span> = <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable language_\">document</span>.<span class=\"property\">readyState</span> == <span class=\"string\">&quot;complete&quot;</span>) &#123;</span><br><span class=\"line\">        <span class=\"title function_\">loadScript</span>(</span><br><span class=\"line\">          <span class=\"string\">&quot;https://cdn.jsdelivr.net/gh/wxydejoy/wxy_bg@main/vendor/simplex-noise.min.js&quot;</span>,</span><br><span class=\"line\">          <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\">        );</span><br><span class=\"line\">        <span class=\"title function_\">loadScript</span>(</span><br><span class=\"line\">          <span class=\"string\">&quot;https://cdn.jsdelivr.net/gh/wxydejoy/wxy_bg@main/vendor/three.min.js&quot;</span>,</span><br><span class=\"line\">          <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">            <span class=\"title function_\">init</span>();</span><br><span class=\"line\">            <span class=\"title function_\">animate</span>();</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        );</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"title function_\">loadlived</span>();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// if (document.body.clientWidth &gt; 768) &#123;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//     init();</span></span><br><span class=\"line\"><span class=\"comment\">//     animate();</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// &#125;;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">rgb2hex</span>(<span class=\"params\">rgb</span>) &#123;</span><br><span class=\"line\">  rgb = rgb.<span class=\"title function_\">match</span>(</span><br><span class=\"line\">    <span class=\"regexp\">/^rgba?[\\s+]?\\([\\s+]?(\\d+)[\\s+]?,[\\s+]?(\\d+)[\\s+]?,[\\s+]?(\\d+)[\\s+]?/i</span></span><br><span class=\"line\">  );</span><br><span class=\"line\">  <span class=\"keyword\">return</span> rgb &amp;&amp; rgb.<span class=\"property\">length</span> === <span class=\"number\">4</span></span><br><span class=\"line\">    ? <span class=\"string\">&quot;&quot;</span> +</span><br><span class=\"line\">        (<span class=\"string\">&quot;0&quot;</span> + <span class=\"built_in\">parseInt</span>(rgb[<span class=\"number\">1</span>], <span class=\"number\">10</span>).<span class=\"title function_\">toString</span>(<span class=\"number\">16</span>)).<span class=\"title function_\">slice</span>(-<span class=\"number\">2</span>) +</span><br><span class=\"line\">        (<span class=\"string\">&quot;0&quot;</span> + <span class=\"built_in\">parseInt</span>(rgb[<span class=\"number\">2</span>], <span class=\"number\">10</span>).<span class=\"title function_\">toString</span>(<span class=\"number\">16</span>)).<span class=\"title function_\">slice</span>(-<span class=\"number\">2</span>) +</span><br><span class=\"line\">        (<span class=\"string\">&quot;0&quot;</span> + <span class=\"built_in\">parseInt</span>(rgb[<span class=\"number\">3</span>], <span class=\"number\">10</span>).<span class=\"title function_\">toString</span>(<span class=\"number\">16</span>)).<span class=\"title function_\">slice</span>(-<span class=\"number\">2</span>)</span><br><span class=\"line\">    : <span class=\"string\">&quot;&quot;</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">init</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> noise = <span class=\"keyword\">new</span> <span class=\"title class_\">SimplexNoise</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">  renderer = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">WebGLRenderer</span>(&#123; <span class=\"attr\">antialias</span>: <span class=\"literal\">true</span>, <span class=\"attr\">alpha</span>: <span class=\"literal\">true</span> &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">  renderer.<span class=\"title function_\">setSize</span>(<span class=\"variable language_\">document</span>.<span class=\"property\">body</span>.<span class=\"property\">clientWidth</span>, <span class=\"variable language_\">document</span>.<span class=\"property\">body</span>.<span class=\"property\">clientHeight</span>);</span><br><span class=\"line\">  <span class=\"comment\">// renderer.autoClear = false;</span></span><br><span class=\"line\">  <span class=\"comment\">// renderer.setClearColor(0x000000, 0.0);</span></span><br><span class=\"line\">  <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(<span class=\"string\">&quot;web_bg&quot;</span>).<span class=\"title function_\">appendChild</span>(renderer.<span class=\"property\">domElement</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">  scene = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">Scene</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">  camera = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">PerspectiveCamera</span>(</span><br><span class=\"line\">    <span class=\"number\">75</span>,</span><br><span class=\"line\">    <span class=\"variable language_\">window</span>.<span class=\"property\">innerWidth</span> / <span class=\"variable language_\">window</span>.<span class=\"property\">innerHeight</span>,</span><br><span class=\"line\">    <span class=\"number\">1</span>,</span><br><span class=\"line\">    <span class=\"number\">1000</span></span><br><span class=\"line\">  );</span><br><span class=\"line\">  camera.<span class=\"property\">position</span>.<span class=\"property\">z</span> = <span class=\"number\">400</span>;</span><br><span class=\"line\">  scene.<span class=\"title function_\">add</span>(camera);</span><br><span class=\"line\"></span><br><span class=\"line\">  circle = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">Object3D</span>();</span><br><span class=\"line\">  skelet = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">Object3D</span>();</span><br><span class=\"line\">  particle = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">Object3D</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">  scene.<span class=\"title function_\">add</span>(circle);</span><br><span class=\"line\">  scene.<span class=\"title function_\">add</span>(skelet);</span><br><span class=\"line\">  scene.<span class=\"title function_\">add</span>(particle);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">var</span> geometry = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">TetrahedronGeometry</span>(<span class=\"number\">2</span>, <span class=\"number\">0</span>); <span class=\"comment\">// random particles</span></span><br><span class=\"line\">  <span class=\"keyword\">var</span> geom = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">IcosahedronGeometry</span>(<span class=\"number\">7</span>, <span class=\"number\">1</span>); <span class=\"comment\">// center planet</span></span><br><span class=\"line\">  geom.<span class=\"property\">verticesNeedUpdate</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> geom2 = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">IcosahedronGeometry</span>(<span class=\"number\">15</span>, <span class=\"number\">1</span>); <span class=\"comment\">// wireframe</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">var</span> material = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">MeshPhongMaterial</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">color</span>: <span class=\"number\">0xffffff</span>,</span><br><span class=\"line\">    <span class=\"attr\">shading</span>: <span class=\"variable constant_\">THREE</span>.<span class=\"property\">FlatShading</span>,</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">  <span class=\"comment\">// 碎片数量</span></span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">100</span>; i++) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> mesh = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">Mesh</span>(geometry, material);</span><br><span class=\"line\">    mesh.<span class=\"property\">position</span></span><br><span class=\"line\">      .<span class=\"title function_\">set</span>(<span class=\"title class_\">Math</span>.<span class=\"title function_\">random</span>() - <span class=\"number\">0.5</span>, <span class=\"title class_\">Math</span>.<span class=\"title function_\">random</span>() - <span class=\"number\">0.5</span>, <span class=\"title class_\">Math</span>.<span class=\"title function_\">random</span>() - <span class=\"number\">0.5</span>)</span><br><span class=\"line\">      .<span class=\"title function_\">normalize</span>();</span><br><span class=\"line\">    mesh.<span class=\"property\">position</span>.<span class=\"title function_\">multiplyScalar</span>(<span class=\"number\">90</span> + <span class=\"title class_\">Math</span>.<span class=\"title function_\">random</span>() * <span class=\"number\">700</span>);</span><br><span class=\"line\">    mesh.<span class=\"property\">rotation</span>.<span class=\"title function_\">set</span>(<span class=\"title class_\">Math</span>.<span class=\"title function_\">random</span>() * <span class=\"number\">2</span>, <span class=\"title class_\">Math</span>.<span class=\"title function_\">random</span>() * <span class=\"number\">2</span>, <span class=\"title class_\">Math</span>.<span class=\"title function_\">random</span>() * <span class=\"number\">2</span>);</span><br><span class=\"line\">    particle.<span class=\"title function_\">add</span>(mesh);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">var</span> mat = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">MeshPhongMaterial</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">color</span>: <span class=\"number\">0x99cccc</span>,</span><br><span class=\"line\">    <span class=\"attr\">shading</span>: <span class=\"variable constant_\">THREE</span>.<span class=\"property\">FlatShading</span>,</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">var</span> mat2 = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">MeshPhongMaterial</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">color</span>: <span class=\"number\">0xffffff</span>,</span><br><span class=\"line\">    <span class=\"attr\">wireframe</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    <span class=\"attr\">side</span>: <span class=\"variable constant_\">THREE</span>.<span class=\"property\">DoubleSide</span>,</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">  planet = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">Mesh</span>(geom, mat);</span><br><span class=\"line\">  planet.<span class=\"property\">verticesNeedUpdate</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">  planet.<span class=\"property\">scale</span>.<span class=\"property\">x</span> = planet.<span class=\"property\">scale</span>.<span class=\"property\">y</span> = planet.<span class=\"property\">scale</span>.<span class=\"property\">z</span> = <span class=\"number\">16</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  circle.<span class=\"title function_\">add</span>(planet);</span><br><span class=\"line\"></span><br><span class=\"line\">  planet2 = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">Mesh</span>(geom2, mat2);</span><br><span class=\"line\">  planet2.<span class=\"property\">scale</span>.<span class=\"property\">x</span> = planet2.<span class=\"property\">scale</span>.<span class=\"property\">y</span> = planet2.<span class=\"property\">scale</span>.<span class=\"property\">z</span> = <span class=\"number\">10</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  skelet.<span class=\"title function_\">add</span>(planet2);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">var</span> ambientLight = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">AmbientLight</span>(<span class=\"number\">0x999999</span>);</span><br><span class=\"line\">  scene.<span class=\"title function_\">add</span>(ambientLight);</span><br><span class=\"line\"></span><br><span class=\"line\">  lights = [];</span><br><span class=\"line\">  lights[<span class=\"number\">0</span>] = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">DirectionalLight</span>(<span class=\"number\">0xffffff</span>, <span class=\"number\">1</span>);</span><br><span class=\"line\">  lights[<span class=\"number\">0</span>].<span class=\"property\">position</span>.<span class=\"title function_\">set</span>(<span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">  lights[<span class=\"number\">1</span>] = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">DirectionalLight</span>(<span class=\"number\">0x01183c</span>, <span class=\"number\">1</span>);</span><br><span class=\"line\">  lights[<span class=\"number\">1</span>].<span class=\"property\">position</span>.<span class=\"title function_\">set</span>(<span class=\"number\">0.75</span>, <span class=\"number\">1</span>, <span class=\"number\">0.5</span>);</span><br><span class=\"line\">  lights[<span class=\"number\">2</span>] = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">DirectionalLight</span>(<span class=\"number\">0x00436f</span>, <span class=\"number\">1</span>);</span><br><span class=\"line\">  lights[<span class=\"number\">2</span>].<span class=\"property\">position</span>.<span class=\"title function_\">set</span>(-<span class=\"number\">0.75</span>, -<span class=\"number\">1</span>, <span class=\"number\">0.5</span>);</span><br><span class=\"line\">  scene.<span class=\"title function_\">add</span>(lights[<span class=\"number\">0</span>]);</span><br><span class=\"line\">  scene.<span class=\"title function_\">add</span>(lights[<span class=\"number\">1</span>]);</span><br><span class=\"line\">  scene.<span class=\"title function_\">add</span>(lights[<span class=\"number\">2</span>]);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">moveObject</span>(<span class=\"params\">prop, math, num, timer = <span class=\"number\">0</span></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (math === <span class=\"string\">&quot;add&quot;</span>) &#123;</span><br><span class=\"line\">    prop += num;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (math === <span class=\"string\">&quot;subtract&quot;</span>) &#123;</span><br><span class=\"line\">    prop -= num;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (math === <span class=\"string\">&quot;bounce&quot;</span>) &#123;</span><br><span class=\"line\">    prop.<span class=\"property\">x</span> += num;</span><br><span class=\"line\">    prop.<span class=\"property\">y</span> += num;</span><br><span class=\"line\">    prop.<span class=\"property\">z</span> += num;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">      prop.<span class=\"property\">x</span> -= num;</span><br><span class=\"line\">      prop.<span class=\"property\">y</span> -= num;</span><br><span class=\"line\">      prop.<span class=\"property\">z</span> -= num;</span><br><span class=\"line\">    &#125;, timer);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">animate</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"title function_\">requestAnimationFrame</span>(animate);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (audio_wireframe) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> planets = [planet, planet2];</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> planets = [planet];</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (audioArray !== <span class=\"literal\">undefined</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// var random = Math.floor(Math.random() * audioArray.length - 100) var amp = 1.1;</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> user_amp = <span class=\"built_in\">eval</span>(<span class=\"string\">&quot;1.&quot;</span>.<span class=\"title function_\">concat</span>(user_audio_amp || <span class=\"string\">&quot;80&quot;</span>));</span><br><span class=\"line\">    <span class=\"keyword\">var</span> bass_user_amp = <span class=\"built_in\">eval</span>(<span class=\"string\">&quot;0.&quot;</span>.<span class=\"title function_\">concat</span>(user_audio_amp || <span class=\"string\">&quot;80&quot;</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// var user_amp = 1.99 var baseAmp = eval(&quot;0.&quot;.concat(user_audio_amp)) planet</span></span><br><span class=\"line\">    planets.<span class=\"title function_\">map</span>(<span class=\"keyword\">function</span> (<span class=\"params\">planet</span>) &#123;</span><br><span class=\"line\">      planet.<span class=\"property\">geometry</span>.<span class=\"property\">vertices</span>.<span class=\"title function_\">forEach</span>(<span class=\"keyword\">function</span> (<span class=\"params\">vertex, i</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> beat = audioArray[i];</span><br><span class=\"line\">        <span class=\"keyword\">var</span> volume = audioArray.<span class=\"title function_\">reduce</span>(<span class=\"keyword\">function</span> (<span class=\"params\">a, b</span>) &#123;</span><br><span class=\"line\">          <span class=\"keyword\">return</span> a + b;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (volume &lt;= <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">          beat = beat * <span class=\"number\">10</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">var</span> offset = planet.<span class=\"property\">geometry</span>.<span class=\"property\">parameters</span>.<span class=\"property\">radius</span>;</span><br><span class=\"line\">        vertex.<span class=\"title function_\">normalize</span>();</span><br><span class=\"line\">        <span class=\"keyword\">var</span> distance;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (user_audio_amp === <span class=\"number\">100</span>) &#123;</span><br><span class=\"line\">          beat = beat * <span class=\"number\">2</span>;</span><br><span class=\"line\">          bass_user_amp = <span class=\"number\">1</span>;</span><br><span class=\"line\">          distance = offset + beat * user_amp;</span><br><span class=\"line\">          <span class=\"comment\">// distance = offset + beat</span></span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">          beat = beat * user_amp;</span><br><span class=\"line\">          <span class=\"keyword\">var</span> time = <span class=\"title class_\">Date</span>.<span class=\"title function_\">now</span>();</span><br><span class=\"line\">          <span class=\"keyword\">var</span> noiseX = vertex.<span class=\"property\">x</span> + time * <span class=\"number\">0.0005</span>;</span><br><span class=\"line\">          <span class=\"keyword\">var</span> noiseY = vertex.<span class=\"property\">y</span> + time * <span class=\"number\">0.0005</span>;</span><br><span class=\"line\">          <span class=\"keyword\">var</span> noiseZ = vertex.<span class=\"property\">z</span> + time * <span class=\"number\">0.0005</span>;</span><br><span class=\"line\">          <span class=\"keyword\">var</span> planetNoise = noise.<span class=\"title function_\">noise3D</span>(noiseX, noiseY, noiseZ);</span><br><span class=\"line\">          distance = offset + planetNoise * beat;</span><br><span class=\"line\">          <span class=\"comment\">// if (turn_liquid) &#123;</span></span><br><span class=\"line\">          <span class=\"comment\">//     distance = offset + beat + user_amp * planetNoise // turns liquid!?</span></span><br><span class=\"line\">          <span class=\"comment\">// &#125;</span></span><br><span class=\"line\">          <span class=\"comment\">// if (distance &gt; 15)&#123;</span></span><br><span class=\"line\">          <span class=\"comment\">//     distance = offset + (beat / 2) * 1.1</span></span><br><span class=\"line\">          <span class=\"comment\">//     debug(distance)</span></span><br><span class=\"line\">          <span class=\"comment\">// &#125;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// var bass_amp = (bass_user_amp &lt; 0.3) ? 0.3 : (1 - bass_user_amp)</span></span><br><span class=\"line\">        <span class=\"keyword\">var</span> bass_amp = <span class=\"number\">1</span> - bass_user_amp;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (bass_amp &lt;= <span class=\"number\">0.3</span>) &#123;</span><br><span class=\"line\">          bass_amp = <span class=\"number\">0.3</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (i &lt;= <span class=\"number\">3</span> &amp;&amp; beat &gt; bass_amp) &#123;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (audio_wireframe === <span class=\"literal\">false</span> &amp;&amp; bass_wireframe) &#123;</span><br><span class=\"line\">            audio_wireframe = <span class=\"literal\">true</span>;</span><br><span class=\"line\">            <span class=\"built_in\">setTimeout</span>(<span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">              audio_wireframe = <span class=\"literal\">false</span>;</span><br><span class=\"line\">            &#125;, <span class=\"number\">250</span>);</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (move_bg) &#123;</span><br><span class=\"line\">            particle.<span class=\"property\">rotation</span>.<span class=\"property\">x</span> += <span class=\"title class_\">Math</span>.<span class=\"title function_\">random</span>() * <span class=\"number\">0.0005</span>;</span><br><span class=\"line\">            particle.<span class=\"property\">rotation</span>.<span class=\"property\">y</span> -= <span class=\"title class_\">Math</span>.<span class=\"title function_\">random</span>() * <span class=\"number\">0.004</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">            circle.<span class=\"property\">rotation</span>.<span class=\"property\">x</span> += <span class=\"number\">0.002</span>;</span><br><span class=\"line\">            circle.<span class=\"property\">rotation</span>.<span class=\"property\">y</span> -= <span class=\"number\">0.004</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">var</span> timer = (beat * <span class=\"number\">100</span>) / <span class=\"number\">0.2</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"title function_\">moveObject</span>(skelet.<span class=\"property\">position</span>, <span class=\"string\">&quot;bounce&quot;</span>, <span class=\"number\">0.05</span>, timer);</span><br><span class=\"line\">            <span class=\"title function_\">moveObject</span>(planet.<span class=\"property\">position</span>, <span class=\"string\">&quot;bounce&quot;</span>, <span class=\"number\">0.05</span>, timer);</span><br><span class=\"line\">            <span class=\"title function_\">moveObject</span>(particle.<span class=\"property\">position</span>, <span class=\"string\">&quot;bounce&quot;</span>, <span class=\"number\">0.05</span>, timer);</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        vertex.<span class=\"title function_\">multiplyScalar</span>(distance &lt;= <span class=\"number\">0.1</span> ? <span class=\"number\">1</span> : distance);</span><br><span class=\"line\">      &#125;);</span><br><span class=\"line\">      planet.<span class=\"property\">geometry</span>.<span class=\"property\">verticesNeedUpdate</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">      planet.<span class=\"property\">geometry</span>.<span class=\"property\">normalsNeedUpdate</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">      planet.<span class=\"property\">geometry</span>.<span class=\"title function_\">computeVertexNormals</span>();</span><br><span class=\"line\">      planet.<span class=\"property\">geometry</span>.<span class=\"title function_\">computeFaceNormals</span>();</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  particle.<span class=\"property\">rotation</span>.<span class=\"property\">x</span> += <span class=\"number\">0.0</span>;</span><br><span class=\"line\">  particle.<span class=\"property\">rotation</span>.<span class=\"property\">y</span> -= <span class=\"number\">0.001</span>;</span><br><span class=\"line\">  circle.<span class=\"property\">rotation</span>.<span class=\"property\">x</span> -= <span class=\"number\">0.002</span>;</span><br><span class=\"line\">  circle.<span class=\"property\">rotation</span>.<span class=\"property\">y</span> -= <span class=\"number\">0.003</span>;</span><br><span class=\"line\">  skelet.<span class=\"property\">rotation</span>.<span class=\"property\">x</span> -= <span class=\"number\">0.001</span>;</span><br><span class=\"line\">  skelet.<span class=\"property\">rotation</span>.<span class=\"property\">y</span> += <span class=\"number\">0.002</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  renderer.<span class=\"title function_\">clear</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">  renderer.<span class=\"title function_\">render</span>(scene, camera);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<link rel=\"stylesheet\" href=\"/css/spoiler.css\" type=\"text/css\"><script src=\"/js/spoiler.js\" type=\"text/javascript\" async></script>","more":"<p>%%% tip home %%%-</p>\n<p>首先感谢大佬的开源项目</p>\n<p>%%% ghcard teachtyler&#x2F;Icosahedron-Geometry %%%-</p>\n<p>还有店长的教程<a href=\"https://akilar.top/posts/23fdf850/\">糖果屋微调合集 | Akilar の糖果屋</a> <a href=\"https://akilar.top/posts/ebf20e02/\">Custom Beautify | Akilar の糖果屋</a></p>\n<p>%%% span red, 未实现：冰球跟随音乐振动 %%%-</p>\n<p>希望有大佬来解决这个问题，我这个小菜鸡实在搞不定。</p>\n<p>有建议请评论区留言，欢迎！！</p>\n<p>7.27 更新：关闭移动端并根据屏幕大小判断是否引入并开启</p>\n<p>%%% endtip %%%-</p>\n<h2 id=\"最终效果\"><a href=\"#最终效果\" class=\"headerlink\" title=\"最终效果\"></a>最终效果</h2><p><img src=\"https://image.wxydejoy.top/img/202107/21/142359%20%E5%8A%A8%E7%94%BB2142.gif\" alt=\"动画2142\"></p>\n<h2 id=\"引入-js\"><a href=\"#引入-js\" class=\"headerlink\" title=\"引入 js\"></a>引入 js</h2><p>只针对 butterfly 主题，其他主题请自己根据情况调整</p>\n<p>icebg.js 代码在最下面</p>\n<p>在<code>_config.butterfly.yml</code>中<code>inject</code>的<code>bottom:</code>插入代码</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-(<span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">data-pjax</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;你自己icebg.js的地址&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span>);</span><br></pre></td></tr></table></figure>\n\n<p>建议修改合适后再通过 jsd 加速插入，因为每个人需求不一样，如果你想要本站一样的效果就改成这样,如果需要自定义请接着看。</p>\n<p>当然，建议读者把代码存到自己仓库</p>\n<p>如果只需要当背景，而不是头图，到这里就够了，如果想要跟本站一样，参考店长头图透明教程在<code>costom.css</code>文件中加入</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/* 头图透明 */</span></span><br><span class=\"line\"><span class=\"selector-id\">#page-header</span>&#123;</span><br><span class=\"line\">  <span class=\"attribute\">background</span>: transparent<span class=\"meta\">!important</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>注意：因为 butterfly 版本迭代，店长教程中的配置手机 PC 页面白天黑夜共四个背景图的第一步请按<code>diff代码</code>块配置。<del>因为我就掉坑了</del></p>\n<p>店长教程点这里<a href=\"https://akilar.top/posts/ebf20e02/\">Custom Beautify | Akilar の糖果屋</a>,建议配合<a href=\"https://akilar.top/posts/23fdf850/\">糖果屋微调合集 | Akilar の糖果屋</a>配置手机 PC 页面白天黑夜共四个背景图食用，效果更佳。</p>\n<p>然后</p>\n<p>然后就没了，就这，对，就这。</p>\n<h2 id=\"自定义\"><a href=\"#自定义\" class=\"headerlink\" title=\"自定义\"></a>自定义</h2><p>建议有一定基础的朋友进行自定义修改，比如把球改到侧边栏</p>\n<p>icebg.js 我放在了<code>source</code>博客根目录，方便调试，读者可以根据情况修改。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-(<span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">data-pjax</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;/icebg.js&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span>);</span><br></pre></td></tr></table></figure>\n\n<p>自定义只需要修改<code>icebg.js</code>内的代码就可以了，代码还是挺长的，其他的我也不会了，大家看着办吧，有大佬改记得评论区告诉我一下。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br><span class=\"line\">259</span><br><span class=\"line\">260</span><br><span class=\"line\">261</span><br><span class=\"line\">262</span><br><span class=\"line\">263</span><br><span class=\"line\">264</span><br><span class=\"line\">265</span><br><span class=\"line\">266</span><br><span class=\"line\">267</span><br><span class=\"line\">268</span><br><span class=\"line\">269</span><br><span class=\"line\">270</span><br><span class=\"line\">271</span><br><span class=\"line\">272</span><br><span class=\"line\">273</span><br><span class=\"line\">274</span><br><span class=\"line\">275</span><br><span class=\"line\">276</span><br><span class=\"line\">277</span><br><span class=\"line\">278</span><br><span class=\"line\">279</span><br><span class=\"line\">280</span><br><span class=\"line\">281</span><br><span class=\"line\">282</span><br><span class=\"line\">283</span><br><span class=\"line\">284</span><br><span class=\"line\">285</span><br><span class=\"line\">286</span><br><span class=\"line\">287</span><br><span class=\"line\">288</span><br><span class=\"line\">289</span><br><span class=\"line\">290</span><br><span class=\"line\">291</span><br><span class=\"line\">292</span><br><span class=\"line\">293</span><br><span class=\"line\">294</span><br><span class=\"line\">295</span><br><span class=\"line\">296</span><br><span class=\"line\">297</span><br><span class=\"line\">298</span><br><span class=\"line\">299</span><br><span class=\"line\">300</span><br><span class=\"line\">301</span><br><span class=\"line\">302</span><br><span class=\"line\">303</span><br><span class=\"line\">304</span><br><span class=\"line\">305</span><br><span class=\"line\">306</span><br><span class=\"line\">307</span><br><span class=\"line\">308</span><br><span class=\"line\">309</span><br><span class=\"line\">310</span><br><span class=\"line\">311</span><br><span class=\"line\">312</span><br><span class=\"line\">313</span><br><span class=\"line\">314</span><br><span class=\"line\">315</span><br><span class=\"line\">316</span><br><span class=\"line\">317</span><br><span class=\"line\">318</span><br><span class=\"line\">319</span><br><span class=\"line\">320</span><br><span class=\"line\">321</span><br><span class=\"line\">322</span><br><span class=\"line\">323</span><br><span class=\"line\">324</span><br><span class=\"line\">325</span><br><span class=\"line\">326</span><br><span class=\"line\">327</span><br><span class=\"line\">328</span><br><span class=\"line\">329</span><br><span class=\"line\">330</span><br><span class=\"line\">331</span><br><span class=\"line\">332</span><br><span class=\"line\">333</span><br><span class=\"line\">334</span><br><span class=\"line\">335</span><br><span class=\"line\">336</span><br><span class=\"line\">337</span><br><span class=\"line\">338</span><br><span class=\"line\">339</span><br><span class=\"line\">340</span><br><span class=\"line\">341</span><br><span class=\"line\">342</span><br><span class=\"line\">343</span><br><span class=\"line\">344</span><br><span class=\"line\">345</span><br><span class=\"line\">346</span><br><span class=\"line\">347</span><br><span class=\"line\">348</span><br><span class=\"line\">349</span><br><span class=\"line\">350</span><br><span class=\"line\">351</span><br><span class=\"line\">352</span><br><span class=\"line\">353</span><br><span class=\"line\">354</span><br><span class=\"line\">355</span><br><span class=\"line\">356</span><br><span class=\"line\">357</span><br><span class=\"line\">358</span><br><span class=\"line\">359</span><br><span class=\"line\">360</span><br><span class=\"line\">361</span><br><span class=\"line\">362</span><br><span class=\"line\">363</span><br><span class=\"line\">364</span><br><span class=\"line\">365</span><br><span class=\"line\">366</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// document.write(&quot;&lt;script  src=&#x27;https://cdn.jsdelivr.net/gh/wxydejoy/wxy_bg@main/vendor/simplex-noise.min.js&#x27;&gt;&lt;/script&gt;&quot;);</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> renderer,</span><br><span class=\"line\">  scene,</span><br><span class=\"line\">  camera,</span><br><span class=\"line\">  composer,</span><br><span class=\"line\">  lights,</span><br><span class=\"line\">  circle,</span><br><span class=\"line\">  skelet,</span><br><span class=\"line\">  particle,</span><br><span class=\"line\">  planet,</span><br><span class=\"line\">  planet2,</span><br><span class=\"line\">  audioArray,</span><br><span class=\"line\">  user_audio_amp,</span><br><span class=\"line\">  audio_wireframe = <span class=\"literal\">true</span>,</span><br><span class=\"line\">  primaryColor = <span class=\"literal\">null</span>,</span><br><span class=\"line\">  secondaryColor = <span class=\"literal\">null</span>,</span><br><span class=\"line\">  thirdColor = <span class=\"literal\">null</span>,</span><br><span class=\"line\">  bg_file,</span><br><span class=\"line\">  move_bg,</span><br><span class=\"line\">  bass_wireframe;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">loadScript</span>(<span class=\"params\">src, callback</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> script = <span class=\"variable language_\">document</span>.<span class=\"title function_\">createElement</span>(<span class=\"string\">&quot;script&quot;</span>),</span><br><span class=\"line\">    head = <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementsByTagName</span>(<span class=\"string\">&quot;head&quot;</span>)[<span class=\"number\">0</span>];</span><br><span class=\"line\">  script.<span class=\"property\">type</span> = <span class=\"string\">&quot;text/javascript&quot;</span>;</span><br><span class=\"line\">  script.<span class=\"property\">charset</span> = <span class=\"string\">&quot;UTF-8&quot;</span>;</span><br><span class=\"line\">  script.<span class=\"property\">src</span> = src;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (script.<span class=\"property\">addEventListener</span>) &#123;</span><br><span class=\"line\">    script.<span class=\"title function_\">addEventListener</span>(</span><br><span class=\"line\">      <span class=\"string\">&quot;load&quot;</span>,</span><br><span class=\"line\">      <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">        <span class=\"title function_\">callback</span>();</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"literal\">false</span></span><br><span class=\"line\">    );</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (script.<span class=\"property\">attachEvent</span>) &#123;</span><br><span class=\"line\">    script.<span class=\"title function_\">attachEvent</span>(<span class=\"string\">&quot;onreadystatechange&quot;</span>, <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">var</span> target = <span class=\"variable language_\">window</span>.<span class=\"property\">event</span>.<span class=\"property\">srcElement</span>;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (target.<span class=\"property\">readyState</span> == <span class=\"string\">&quot;loaded&quot;</span>) &#123;</span><br><span class=\"line\">        <span class=\"title function_\">callback</span>();</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  head.<span class=\"title function_\">appendChild</span>(script);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">loadlived</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"variable language_\">document</span>.<span class=\"property\">body</span>.<span class=\"property\">clientWidth</span> &gt; <span class=\"number\">900</span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">document</span>.<span class=\"property\">onreadystatechange</span> = <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable language_\">document</span>.<span class=\"property\">readyState</span> == <span class=\"string\">&quot;complete&quot;</span>) &#123;</span><br><span class=\"line\">        <span class=\"title function_\">loadScript</span>(</span><br><span class=\"line\">          <span class=\"string\">&quot;https://cdn.jsdelivr.net/gh/wxydejoy/wxy_bg@main/vendor/simplex-noise.min.js&quot;</span>,</span><br><span class=\"line\">          <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\">        );</span><br><span class=\"line\">        <span class=\"title function_\">loadScript</span>(</span><br><span class=\"line\">          <span class=\"string\">&quot;https://cdn.jsdelivr.net/gh/wxydejoy/wxy_bg@main/vendor/three.min.js&quot;</span>,</span><br><span class=\"line\">          <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">            <span class=\"title function_\">init</span>();</span><br><span class=\"line\">            <span class=\"title function_\">animate</span>();</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        );</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"title function_\">loadlived</span>();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// if (document.body.clientWidth &gt; 768) &#123;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//     init();</span></span><br><span class=\"line\"><span class=\"comment\">//     animate();</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// &#125;;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// document.write(&quot;&lt;script  src=&#x27;https://cdn.jsdelivr.net/gh/wxydejoy/wxy_bg@main/vendor/simplex-noise.min.js&#x27;&gt;&lt;/script&gt;&quot;);</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> renderer,</span><br><span class=\"line\">  scene,</span><br><span class=\"line\">  camera,</span><br><span class=\"line\">  composer,</span><br><span class=\"line\">  lights,</span><br><span class=\"line\">  circle,</span><br><span class=\"line\">  skelet,</span><br><span class=\"line\">  particle,</span><br><span class=\"line\">  planet,</span><br><span class=\"line\">  planet2,</span><br><span class=\"line\">  audioArray,</span><br><span class=\"line\">  user_audio_amp,</span><br><span class=\"line\">  audio_wireframe = <span class=\"literal\">true</span>,</span><br><span class=\"line\">  primaryColor = <span class=\"literal\">null</span>,</span><br><span class=\"line\">  secondaryColor = <span class=\"literal\">null</span>,</span><br><span class=\"line\">  thirdColor = <span class=\"literal\">null</span>,</span><br><span class=\"line\">  bg_file,</span><br><span class=\"line\">  move_bg,</span><br><span class=\"line\">  bass_wireframe;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">loadScript</span>(<span class=\"params\">src, callback</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> script = <span class=\"variable language_\">document</span>.<span class=\"title function_\">createElement</span>(<span class=\"string\">&quot;script&quot;</span>),</span><br><span class=\"line\">    head = <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementsByTagName</span>(<span class=\"string\">&quot;head&quot;</span>)[<span class=\"number\">0</span>];</span><br><span class=\"line\">  script.<span class=\"property\">type</span> = <span class=\"string\">&quot;text/javascript&quot;</span>;</span><br><span class=\"line\">  script.<span class=\"property\">charset</span> = <span class=\"string\">&quot;UTF-8&quot;</span>;</span><br><span class=\"line\">  script.<span class=\"property\">src</span> = src;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (script.<span class=\"property\">addEventListener</span>) &#123;</span><br><span class=\"line\">    script.<span class=\"title function_\">addEventListener</span>(</span><br><span class=\"line\">      <span class=\"string\">&quot;load&quot;</span>,</span><br><span class=\"line\">      <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">        <span class=\"title function_\">callback</span>();</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"literal\">false</span></span><br><span class=\"line\">    );</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (script.<span class=\"property\">attachEvent</span>) &#123;</span><br><span class=\"line\">    script.<span class=\"title function_\">attachEvent</span>(<span class=\"string\">&quot;onreadystatechange&quot;</span>, <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">var</span> target = <span class=\"variable language_\">window</span>.<span class=\"property\">event</span>.<span class=\"property\">srcElement</span>;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (target.<span class=\"property\">readyState</span> == <span class=\"string\">&quot;loaded&quot;</span>) &#123;</span><br><span class=\"line\">        <span class=\"title function_\">callback</span>();</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  head.<span class=\"title function_\">appendChild</span>(script);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">loadlived</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"variable language_\">document</span>.<span class=\"property\">body</span>.<span class=\"property\">clientWidth</span> &gt; <span class=\"number\">900</span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">document</span>.<span class=\"property\">onreadystatechange</span> = <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable language_\">document</span>.<span class=\"property\">readyState</span> == <span class=\"string\">&quot;complete&quot;</span>) &#123;</span><br><span class=\"line\">        <span class=\"title function_\">loadScript</span>(</span><br><span class=\"line\">          <span class=\"string\">&quot;https://cdn.jsdelivr.net/gh/wxydejoy/wxy_bg@main/vendor/simplex-noise.min.js&quot;</span>,</span><br><span class=\"line\">          <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;&#125;</span><br><span class=\"line\">        );</span><br><span class=\"line\">        <span class=\"title function_\">loadScript</span>(</span><br><span class=\"line\">          <span class=\"string\">&quot;https://cdn.jsdelivr.net/gh/wxydejoy/wxy_bg@main/vendor/three.min.js&quot;</span>,</span><br><span class=\"line\">          <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">            <span class=\"title function_\">init</span>();</span><br><span class=\"line\">            <span class=\"title function_\">animate</span>();</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        );</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"title function_\">loadlived</span>();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// if (document.body.clientWidth &gt; 768) &#123;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//     init();</span></span><br><span class=\"line\"><span class=\"comment\">//     animate();</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// &#125;;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">rgb2hex</span>(<span class=\"params\">rgb</span>) &#123;</span><br><span class=\"line\">  rgb = rgb.<span class=\"title function_\">match</span>(</span><br><span class=\"line\">    <span class=\"regexp\">/^rgba?[\\s+]?\\([\\s+]?(\\d+)[\\s+]?,[\\s+]?(\\d+)[\\s+]?,[\\s+]?(\\d+)[\\s+]?/i</span></span><br><span class=\"line\">  );</span><br><span class=\"line\">  <span class=\"keyword\">return</span> rgb &amp;&amp; rgb.<span class=\"property\">length</span> === <span class=\"number\">4</span></span><br><span class=\"line\">    ? <span class=\"string\">&quot;&quot;</span> +</span><br><span class=\"line\">        (<span class=\"string\">&quot;0&quot;</span> + <span class=\"built_in\">parseInt</span>(rgb[<span class=\"number\">1</span>], <span class=\"number\">10</span>).<span class=\"title function_\">toString</span>(<span class=\"number\">16</span>)).<span class=\"title function_\">slice</span>(-<span class=\"number\">2</span>) +</span><br><span class=\"line\">        (<span class=\"string\">&quot;0&quot;</span> + <span class=\"built_in\">parseInt</span>(rgb[<span class=\"number\">2</span>], <span class=\"number\">10</span>).<span class=\"title function_\">toString</span>(<span class=\"number\">16</span>)).<span class=\"title function_\">slice</span>(-<span class=\"number\">2</span>) +</span><br><span class=\"line\">        (<span class=\"string\">&quot;0&quot;</span> + <span class=\"built_in\">parseInt</span>(rgb[<span class=\"number\">3</span>], <span class=\"number\">10</span>).<span class=\"title function_\">toString</span>(<span class=\"number\">16</span>)).<span class=\"title function_\">slice</span>(-<span class=\"number\">2</span>)</span><br><span class=\"line\">    : <span class=\"string\">&quot;&quot;</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">init</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> noise = <span class=\"keyword\">new</span> <span class=\"title class_\">SimplexNoise</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">  renderer = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">WebGLRenderer</span>(&#123; <span class=\"attr\">antialias</span>: <span class=\"literal\">true</span>, <span class=\"attr\">alpha</span>: <span class=\"literal\">true</span> &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">  renderer.<span class=\"title function_\">setSize</span>(<span class=\"variable language_\">document</span>.<span class=\"property\">body</span>.<span class=\"property\">clientWidth</span>, <span class=\"variable language_\">document</span>.<span class=\"property\">body</span>.<span class=\"property\">clientHeight</span>);</span><br><span class=\"line\">  <span class=\"comment\">// renderer.autoClear = false;</span></span><br><span class=\"line\">  <span class=\"comment\">// renderer.setClearColor(0x000000, 0.0);</span></span><br><span class=\"line\">  <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(<span class=\"string\">&quot;web_bg&quot;</span>).<span class=\"title function_\">appendChild</span>(renderer.<span class=\"property\">domElement</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">  scene = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">Scene</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">  camera = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">PerspectiveCamera</span>(</span><br><span class=\"line\">    <span class=\"number\">75</span>,</span><br><span class=\"line\">    <span class=\"variable language_\">window</span>.<span class=\"property\">innerWidth</span> / <span class=\"variable language_\">window</span>.<span class=\"property\">innerHeight</span>,</span><br><span class=\"line\">    <span class=\"number\">1</span>,</span><br><span class=\"line\">    <span class=\"number\">1000</span></span><br><span class=\"line\">  );</span><br><span class=\"line\">  camera.<span class=\"property\">position</span>.<span class=\"property\">z</span> = <span class=\"number\">400</span>;</span><br><span class=\"line\">  scene.<span class=\"title function_\">add</span>(camera);</span><br><span class=\"line\"></span><br><span class=\"line\">  circle = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">Object3D</span>();</span><br><span class=\"line\">  skelet = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">Object3D</span>();</span><br><span class=\"line\">  particle = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">Object3D</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">  scene.<span class=\"title function_\">add</span>(circle);</span><br><span class=\"line\">  scene.<span class=\"title function_\">add</span>(skelet);</span><br><span class=\"line\">  scene.<span class=\"title function_\">add</span>(particle);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">var</span> geometry = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">TetrahedronGeometry</span>(<span class=\"number\">2</span>, <span class=\"number\">0</span>); <span class=\"comment\">// random particles</span></span><br><span class=\"line\">  <span class=\"keyword\">var</span> geom = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">IcosahedronGeometry</span>(<span class=\"number\">7</span>, <span class=\"number\">1</span>); <span class=\"comment\">// center planet</span></span><br><span class=\"line\">  geom.<span class=\"property\">verticesNeedUpdate</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> geom2 = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">IcosahedronGeometry</span>(<span class=\"number\">15</span>, <span class=\"number\">1</span>); <span class=\"comment\">// wireframe</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">var</span> material = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">MeshPhongMaterial</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">color</span>: <span class=\"number\">0xffffff</span>,</span><br><span class=\"line\">    <span class=\"attr\">shading</span>: <span class=\"variable constant_\">THREE</span>.<span class=\"property\">FlatShading</span>,</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">  <span class=\"comment\">// 碎片数量</span></span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">100</span>; i++) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> mesh = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">Mesh</span>(geometry, material);</span><br><span class=\"line\">    mesh.<span class=\"property\">position</span></span><br><span class=\"line\">      .<span class=\"title function_\">set</span>(<span class=\"title class_\">Math</span>.<span class=\"title function_\">random</span>() - <span class=\"number\">0.5</span>, <span class=\"title class_\">Math</span>.<span class=\"title function_\">random</span>() - <span class=\"number\">0.5</span>, <span class=\"title class_\">Math</span>.<span class=\"title function_\">random</span>() - <span class=\"number\">0.5</span>)</span><br><span class=\"line\">      .<span class=\"title function_\">normalize</span>();</span><br><span class=\"line\">    mesh.<span class=\"property\">position</span>.<span class=\"title function_\">multiplyScalar</span>(<span class=\"number\">90</span> + <span class=\"title class_\">Math</span>.<span class=\"title function_\">random</span>() * <span class=\"number\">700</span>);</span><br><span class=\"line\">    mesh.<span class=\"property\">rotation</span>.<span class=\"title function_\">set</span>(<span class=\"title class_\">Math</span>.<span class=\"title function_\">random</span>() * <span class=\"number\">2</span>, <span class=\"title class_\">Math</span>.<span class=\"title function_\">random</span>() * <span class=\"number\">2</span>, <span class=\"title class_\">Math</span>.<span class=\"title function_\">random</span>() * <span class=\"number\">2</span>);</span><br><span class=\"line\">    particle.<span class=\"title function_\">add</span>(mesh);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">var</span> mat = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">MeshPhongMaterial</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">color</span>: <span class=\"number\">0x99cccc</span>,</span><br><span class=\"line\">    <span class=\"attr\">shading</span>: <span class=\"variable constant_\">THREE</span>.<span class=\"property\">FlatShading</span>,</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">var</span> mat2 = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">MeshPhongMaterial</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">color</span>: <span class=\"number\">0xffffff</span>,</span><br><span class=\"line\">    <span class=\"attr\">wireframe</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    <span class=\"attr\">side</span>: <span class=\"variable constant_\">THREE</span>.<span class=\"property\">DoubleSide</span>,</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">  planet = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">Mesh</span>(geom, mat);</span><br><span class=\"line\">  planet.<span class=\"property\">verticesNeedUpdate</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">  planet.<span class=\"property\">scale</span>.<span class=\"property\">x</span> = planet.<span class=\"property\">scale</span>.<span class=\"property\">y</span> = planet.<span class=\"property\">scale</span>.<span class=\"property\">z</span> = <span class=\"number\">16</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  circle.<span class=\"title function_\">add</span>(planet);</span><br><span class=\"line\"></span><br><span class=\"line\">  planet2 = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">Mesh</span>(geom2, mat2);</span><br><span class=\"line\">  planet2.<span class=\"property\">scale</span>.<span class=\"property\">x</span> = planet2.<span class=\"property\">scale</span>.<span class=\"property\">y</span> = planet2.<span class=\"property\">scale</span>.<span class=\"property\">z</span> = <span class=\"number\">10</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  skelet.<span class=\"title function_\">add</span>(planet2);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">var</span> ambientLight = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">AmbientLight</span>(<span class=\"number\">0x999999</span>);</span><br><span class=\"line\">  scene.<span class=\"title function_\">add</span>(ambientLight);</span><br><span class=\"line\"></span><br><span class=\"line\">  lights = [];</span><br><span class=\"line\">  lights[<span class=\"number\">0</span>] = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">DirectionalLight</span>(<span class=\"number\">0xffffff</span>, <span class=\"number\">1</span>);</span><br><span class=\"line\">  lights[<span class=\"number\">0</span>].<span class=\"property\">position</span>.<span class=\"title function_\">set</span>(<span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">  lights[<span class=\"number\">1</span>] = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">DirectionalLight</span>(<span class=\"number\">0x01183c</span>, <span class=\"number\">1</span>);</span><br><span class=\"line\">  lights[<span class=\"number\">1</span>].<span class=\"property\">position</span>.<span class=\"title function_\">set</span>(<span class=\"number\">0.75</span>, <span class=\"number\">1</span>, <span class=\"number\">0.5</span>);</span><br><span class=\"line\">  lights[<span class=\"number\">2</span>] = <span class=\"keyword\">new</span> <span class=\"variable constant_\">THREE</span>.<span class=\"title class_\">DirectionalLight</span>(<span class=\"number\">0x00436f</span>, <span class=\"number\">1</span>);</span><br><span class=\"line\">  lights[<span class=\"number\">2</span>].<span class=\"property\">position</span>.<span class=\"title function_\">set</span>(-<span class=\"number\">0.75</span>, -<span class=\"number\">1</span>, <span class=\"number\">0.5</span>);</span><br><span class=\"line\">  scene.<span class=\"title function_\">add</span>(lights[<span class=\"number\">0</span>]);</span><br><span class=\"line\">  scene.<span class=\"title function_\">add</span>(lights[<span class=\"number\">1</span>]);</span><br><span class=\"line\">  scene.<span class=\"title function_\">add</span>(lights[<span class=\"number\">2</span>]);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">moveObject</span>(<span class=\"params\">prop, math, num, timer = <span class=\"number\">0</span></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (math === <span class=\"string\">&quot;add&quot;</span>) &#123;</span><br><span class=\"line\">    prop += num;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (math === <span class=\"string\">&quot;subtract&quot;</span>) &#123;</span><br><span class=\"line\">    prop -= num;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (math === <span class=\"string\">&quot;bounce&quot;</span>) &#123;</span><br><span class=\"line\">    prop.<span class=\"property\">x</span> += num;</span><br><span class=\"line\">    prop.<span class=\"property\">y</span> += num;</span><br><span class=\"line\">    prop.<span class=\"property\">z</span> += num;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">      prop.<span class=\"property\">x</span> -= num;</span><br><span class=\"line\">      prop.<span class=\"property\">y</span> -= num;</span><br><span class=\"line\">      prop.<span class=\"property\">z</span> -= num;</span><br><span class=\"line\">    &#125;, timer);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">animate</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"title function_\">requestAnimationFrame</span>(animate);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (audio_wireframe) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> planets = [planet, planet2];</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> planets = [planet];</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (audioArray !== <span class=\"literal\">undefined</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// var random = Math.floor(Math.random() * audioArray.length - 100) var amp = 1.1;</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> user_amp = <span class=\"built_in\">eval</span>(<span class=\"string\">&quot;1.&quot;</span>.<span class=\"title function_\">concat</span>(user_audio_amp || <span class=\"string\">&quot;80&quot;</span>));</span><br><span class=\"line\">    <span class=\"keyword\">var</span> bass_user_amp = <span class=\"built_in\">eval</span>(<span class=\"string\">&quot;0.&quot;</span>.<span class=\"title function_\">concat</span>(user_audio_amp || <span class=\"string\">&quot;80&quot;</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// var user_amp = 1.99 var baseAmp = eval(&quot;0.&quot;.concat(user_audio_amp)) planet</span></span><br><span class=\"line\">    planets.<span class=\"title function_\">map</span>(<span class=\"keyword\">function</span> (<span class=\"params\">planet</span>) &#123;</span><br><span class=\"line\">      planet.<span class=\"property\">geometry</span>.<span class=\"property\">vertices</span>.<span class=\"title function_\">forEach</span>(<span class=\"keyword\">function</span> (<span class=\"params\">vertex, i</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> beat = audioArray[i];</span><br><span class=\"line\">        <span class=\"keyword\">var</span> volume = audioArray.<span class=\"title function_\">reduce</span>(<span class=\"keyword\">function</span> (<span class=\"params\">a, b</span>) &#123;</span><br><span class=\"line\">          <span class=\"keyword\">return</span> a + b;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (volume &lt;= <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">          beat = beat * <span class=\"number\">10</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">var</span> offset = planet.<span class=\"property\">geometry</span>.<span class=\"property\">parameters</span>.<span class=\"property\">radius</span>;</span><br><span class=\"line\">        vertex.<span class=\"title function_\">normalize</span>();</span><br><span class=\"line\">        <span class=\"keyword\">var</span> distance;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (user_audio_amp === <span class=\"number\">100</span>) &#123;</span><br><span class=\"line\">          beat = beat * <span class=\"number\">2</span>;</span><br><span class=\"line\">          bass_user_amp = <span class=\"number\">1</span>;</span><br><span class=\"line\">          distance = offset + beat * user_amp;</span><br><span class=\"line\">          <span class=\"comment\">// distance = offset + beat</span></span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">          beat = beat * user_amp;</span><br><span class=\"line\">          <span class=\"keyword\">var</span> time = <span class=\"title class_\">Date</span>.<span class=\"title function_\">now</span>();</span><br><span class=\"line\">          <span class=\"keyword\">var</span> noiseX = vertex.<span class=\"property\">x</span> + time * <span class=\"number\">0.0005</span>;</span><br><span class=\"line\">          <span class=\"keyword\">var</span> noiseY = vertex.<span class=\"property\">y</span> + time * <span class=\"number\">0.0005</span>;</span><br><span class=\"line\">          <span class=\"keyword\">var</span> noiseZ = vertex.<span class=\"property\">z</span> + time * <span class=\"number\">0.0005</span>;</span><br><span class=\"line\">          <span class=\"keyword\">var</span> planetNoise = noise.<span class=\"title function_\">noise3D</span>(noiseX, noiseY, noiseZ);</span><br><span class=\"line\">          distance = offset + planetNoise * beat;</span><br><span class=\"line\">          <span class=\"comment\">// if (turn_liquid) &#123;</span></span><br><span class=\"line\">          <span class=\"comment\">//     distance = offset + beat + user_amp * planetNoise // turns liquid!?</span></span><br><span class=\"line\">          <span class=\"comment\">// &#125;</span></span><br><span class=\"line\">          <span class=\"comment\">// if (distance &gt; 15)&#123;</span></span><br><span class=\"line\">          <span class=\"comment\">//     distance = offset + (beat / 2) * 1.1</span></span><br><span class=\"line\">          <span class=\"comment\">//     debug(distance)</span></span><br><span class=\"line\">          <span class=\"comment\">// &#125;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// var bass_amp = (bass_user_amp &lt; 0.3) ? 0.3 : (1 - bass_user_amp)</span></span><br><span class=\"line\">        <span class=\"keyword\">var</span> bass_amp = <span class=\"number\">1</span> - bass_user_amp;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (bass_amp &lt;= <span class=\"number\">0.3</span>) &#123;</span><br><span class=\"line\">          bass_amp = <span class=\"number\">0.3</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (i &lt;= <span class=\"number\">3</span> &amp;&amp; beat &gt; bass_amp) &#123;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (audio_wireframe === <span class=\"literal\">false</span> &amp;&amp; bass_wireframe) &#123;</span><br><span class=\"line\">            audio_wireframe = <span class=\"literal\">true</span>;</span><br><span class=\"line\">            <span class=\"built_in\">setTimeout</span>(<span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">              audio_wireframe = <span class=\"literal\">false</span>;</span><br><span class=\"line\">            &#125;, <span class=\"number\">250</span>);</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (move_bg) &#123;</span><br><span class=\"line\">            particle.<span class=\"property\">rotation</span>.<span class=\"property\">x</span> += <span class=\"title class_\">Math</span>.<span class=\"title function_\">random</span>() * <span class=\"number\">0.0005</span>;</span><br><span class=\"line\">            particle.<span class=\"property\">rotation</span>.<span class=\"property\">y</span> -= <span class=\"title class_\">Math</span>.<span class=\"title function_\">random</span>() * <span class=\"number\">0.004</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">            circle.<span class=\"property\">rotation</span>.<span class=\"property\">x</span> += <span class=\"number\">0.002</span>;</span><br><span class=\"line\">            circle.<span class=\"property\">rotation</span>.<span class=\"property\">y</span> -= <span class=\"number\">0.004</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">var</span> timer = (beat * <span class=\"number\">100</span>) / <span class=\"number\">0.2</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"title function_\">moveObject</span>(skelet.<span class=\"property\">position</span>, <span class=\"string\">&quot;bounce&quot;</span>, <span class=\"number\">0.05</span>, timer);</span><br><span class=\"line\">            <span class=\"title function_\">moveObject</span>(planet.<span class=\"property\">position</span>, <span class=\"string\">&quot;bounce&quot;</span>, <span class=\"number\">0.05</span>, timer);</span><br><span class=\"line\">            <span class=\"title function_\">moveObject</span>(particle.<span class=\"property\">position</span>, <span class=\"string\">&quot;bounce&quot;</span>, <span class=\"number\">0.05</span>, timer);</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        vertex.<span class=\"title function_\">multiplyScalar</span>(distance &lt;= <span class=\"number\">0.1</span> ? <span class=\"number\">1</span> : distance);</span><br><span class=\"line\">      &#125;);</span><br><span class=\"line\">      planet.<span class=\"property\">geometry</span>.<span class=\"property\">verticesNeedUpdate</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">      planet.<span class=\"property\">geometry</span>.<span class=\"property\">normalsNeedUpdate</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">      planet.<span class=\"property\">geometry</span>.<span class=\"title function_\">computeVertexNormals</span>();</span><br><span class=\"line\">      planet.<span class=\"property\">geometry</span>.<span class=\"title function_\">computeFaceNormals</span>();</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  particle.<span class=\"property\">rotation</span>.<span class=\"property\">x</span> += <span class=\"number\">0.0</span>;</span><br><span class=\"line\">  particle.<span class=\"property\">rotation</span>.<span class=\"property\">y</span> -= <span class=\"number\">0.001</span>;</span><br><span class=\"line\">  circle.<span class=\"property\">rotation</span>.<span class=\"property\">x</span> -= <span class=\"number\">0.002</span>;</span><br><span class=\"line\">  circle.<span class=\"property\">rotation</span>.<span class=\"property\">y</span> -= <span class=\"number\">0.003</span>;</span><br><span class=\"line\">  skelet.<span class=\"property\">rotation</span>.<span class=\"property\">x</span> -= <span class=\"number\">0.001</span>;</span><br><span class=\"line\">  skelet.<span class=\"property\">rotation</span>.<span class=\"property\">y</span> += <span class=\"number\">0.002</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  renderer.<span class=\"title function_\">clear</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">  renderer.<span class=\"title function_\">render</span>(scene, camera);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","categories":[{"name":"💻Code","path":"api/categories/💻Code.json"}],"tags":[{"name":"💻Hexo","path":"api/tags/💻Hexo.json"}]}
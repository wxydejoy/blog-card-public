{"title":"Python çˆ¬è™«ä¹‹ DrissionPage","slug":"post/code/py/Python çˆ¬è™«ä¹‹ DrissionPage","date":"2024-03-15T01:56:24.000Z","updated":"2024-03-15T01:56:24.000Z","comments":true,"path":"api/articles/post/code/py/Python çˆ¬è™«ä¹‹ DrissionPage.json","excerpt":null,"covers":null,"content":"<h2 id=\"DrissionPage-æ˜¯ä»€ä¹ˆ\"><a href=\"#DrissionPage-æ˜¯ä»€ä¹ˆ\" class=\"headerlink\" title=\"DrissionPage æ˜¯ä»€ä¹ˆ\"></a>DrissionPage æ˜¯ä»€ä¹ˆ</h2><p>DrissionPage æ˜¯ä¸€ä¸ªåŸºäº python çš„ç½‘é¡µè‡ªåŠ¨åŒ–å·¥å…·ã€‚<br>å®ƒæ—¢èƒ½æ§åˆ¶æµè§ˆå™¨ï¼Œä¹Ÿèƒ½æ”¶å‘æ•°æ®åŒ…ï¼Œè¿˜èƒ½æŠŠä¸¤è€…åˆè€Œä¸ºä¸€ã€‚<br>å¯å…¼é¡¾æµè§ˆå™¨è‡ªåŠ¨åŒ–çš„ä¾¿åˆ©æ€§å’Œ requests çš„é«˜æ•ˆç‡ã€‚<br>å®ƒåŠŸèƒ½å¼ºå¤§ï¼Œå†…ç½®æ— æ•°äººæ€§åŒ–è®¾è®¡å’Œä¾¿æ·åŠŸèƒ½ã€‚<br>å®ƒçš„è¯­æ³•ç®€æ´è€Œä¼˜é›…ï¼Œä»£ç é‡å°‘ï¼Œå¯¹æ–°æ‰‹å‹å¥½ã€‚</p>\n<p>ç”¨ requests åšæ•°æ®é‡‡é›†é¢å¯¹è¦ç™»å½•çš„ç½‘ç«™æ—¶ï¼Œè¦åˆ†ææ•°æ®åŒ…ã€JS æºç ï¼Œæ„é€ å¤æ‚çš„è¯·æ±‚ï¼Œå¾€å¾€è¿˜è¦åº”ä»˜éªŒè¯ç ã€JS æ··æ·†ã€ç­¾åå‚æ•°ç­‰åçˆ¬æ‰‹æ®µï¼Œé—¨æ§›è¾ƒé«˜ï¼Œå¼€å‘æ•ˆç‡ä¸é«˜ã€‚ä½¿ç”¨æµè§ˆå™¨ï¼Œå¯ä»¥å¾ˆå¤§ç¨‹åº¦ä¸Šç»•è¿‡è¿™äº›å‘ï¼Œä½†æµè§ˆå™¨è¿è¡Œæ•ˆç‡ä¸é«˜ã€‚</p>\n<p>å› æ­¤ï¼Œè¿™ä¸ªåº“è®¾è®¡åˆè¡·ï¼Œæ˜¯å°†å®ƒä»¬åˆè€Œä¸ºä¸€ï¼ŒåŒæ—¶å®ç°â€œå†™å¾—å¿«â€å’Œâ€œè·‘å¾—å¿«â€ã€‚èƒ½å¤Ÿåœ¨ä¸åŒéœ€è¦æ—¶åˆ‡æ¢ç›¸åº”æ¨¡å¼ï¼Œå¹¶æä¾›ä¸€ç§äººæ€§åŒ–çš„ä½¿ç”¨æ–¹æ³•ï¼Œæé«˜å¼€å‘å’Œè¿è¡Œæ•ˆç‡ã€‚<br>é™¤äº†åˆå¹¶ä¸¤è€…ï¼Œæœ¬åº“è¿˜ä»¥ç½‘é¡µä¸ºå•ä½å°è£…äº†å¸¸ç”¨åŠŸèƒ½ï¼Œæä¾›éå¸¸ç®€ä¾¿çš„æ“ä½œå’Œè¯­å¥ï¼Œä½¿ç”¨æˆ·å¯å‡å°‘è€ƒè™‘ç»†èŠ‚ï¼Œä¸“æ³¨åŠŸèƒ½å®ç°ã€‚ ä»¥ç®€å•çš„æ–¹å¼å®ç°å¼ºå¤§çš„åŠŸèƒ½ï¼Œä½¿ä»£ç æ›´ä¼˜é›…ã€‚</p>\n<p>ä»¥å‰çš„ç‰ˆæœ¬æ˜¯å¯¹ selenium è¿›è¡Œé‡æ–°å°è£…å®ç°çš„ã€‚ä» 3.0 å¼€å§‹ï¼Œä½œè€…å¦èµ·ç‚‰ç¶ï¼Œå¯¹åº•å±‚è¿›è¡Œäº†é‡æ–°å¼€å‘ï¼Œæ‘†è„±å¯¹ selenium çš„ä¾èµ–ï¼Œå¢å¼ºäº†åŠŸèƒ½ï¼Œæå‡äº†è¿è¡Œæ•ˆç‡ã€‚</p>\n<h2 id=\"ç¤ºä¾‹ä»£ç \"><a href=\"#ç¤ºä¾‹ä»£ç \" class=\"headerlink\" title=\"ç¤ºä¾‹ä»£ç \"></a>ç¤ºä¾‹ä»£ç </h2><figure class=\"highlight nsis\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from DrissionPage import ChromiumPage</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ›å»ºé¡µé¢å¯¹è±¡ï¼Œå¹¶å¯åŠ¨æˆ–æ¥ç®¡æµè§ˆå™¨</span></span><br><span class=\"line\"><span class=\"keyword\">page</span> = ChromiumPage()</span><br><span class=\"line\"><span class=\"comment\"># è·³è½¬åˆ°ç™»å½•é¡µé¢</span></span><br><span class=\"line\"><span class=\"keyword\">page</span>.get(<span class=\"string\">&#x27;https://gitee.com/login&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å®šä½åˆ°è´¦å·æ–‡æœ¬æ¡†ï¼Œè·å–æ–‡æœ¬æ¡†å…ƒç´ </span></span><br><span class=\"line\">ele = <span class=\"keyword\">page</span>.ele(<span class=\"string\">&#x27;#user_login&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\"># è¾“å…¥å¯¹æ–‡æœ¬æ¡†è¾“å…¥è´¦å·</span></span><br><span class=\"line\">ele.input(<span class=\"string\">&#x27;æ‚¨çš„è´¦å·&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\"># å®šä½åˆ°å¯†ç æ–‡æœ¬æ¡†å¹¶è¾“å…¥å¯†ç </span></span><br><span class=\"line\"><span class=\"keyword\">page</span>.ele(<span class=\"string\">&#x27;#user_password&#x27;</span>).input(<span class=\"string\">&#x27;æ‚¨çš„å¯†ç &#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\"># ç‚¹å‡»ç™»å½•æŒ‰é’®</span></span><br><span class=\"line\"><span class=\"keyword\">page</span>.ele(<span class=\"string\">&#x27;@value=ç™» å½•&#x27;</span>).click()</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"åº”ç”¨å®ä¾‹\"><a href=\"#åº”ç”¨å®ä¾‹\" class=\"headerlink\" title=\"åº”ç”¨å®ä¾‹\"></a>åº”ç”¨å®ä¾‹</h2><h3 id=\"æ·˜å®å•†å“æˆªå›¾\"><a href=\"#æ·˜å®å•†å“æˆªå›¾\" class=\"headerlink\" title=\"æ·˜å®å•†å“æˆªå›¾\"></a>æ·˜å®å•†å“æˆªå›¾</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># éƒ¨åˆ†ä»£ç </span></span><br><span class=\"line\">page = ChromiumPage(co)</span><br><span class=\"line\">page.get(img_url,retry=<span class=\"number\">1</span>, interval=<span class=\"number\">1</span>, timeout=<span class=\"number\">1.5</span>)</span><br><span class=\"line\">                </span><br><span class=\"line\">img = page(<span class=\"string\">&#x27;tag:img&#x27;</span>)</span><br><span class=\"line\">img.get_screenshot(path=<span class=\"string\">&#x27;./&#x27;</span>, name=<span class=\"string\">&#x27;temp_img.jpg&#x27;</span>)</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"æœªæ¥å·¥å‚è®¢å•æ•°æ®çˆ¬å–\"><a href=\"#æœªæ¥å·¥å‚è®¢å•æ•°æ®çˆ¬å–\" class=\"headerlink\" title=\"æœªæ¥å·¥å‚è®¢å•æ•°æ®çˆ¬å–\"></a>æœªæ¥å·¥å‚è®¢å•æ•°æ®çˆ¬å–</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> DrissionPage <span class=\"keyword\">import</span> SessionPage, SessionOptions <span class=\"comment\"># pip install DrissionPage</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> DrissionPage <span class=\"keyword\">import</span> ChromiumPage</span><br><span class=\"line\"><span class=\"keyword\">from</span> DrissionPage <span class=\"keyword\">import</span> ChromiumOptions</span><br><span class=\"line\"><span class=\"keyword\">import</span> re</span><br><span class=\"line\"><span class=\"keyword\">import</span> time</span><br><span class=\"line\"></span><br><span class=\"line\">co = ChromiumOptions(read_file=<span class=\"literal\">False</span>)  <span class=\"comment\"># ä¸è¯»å–æ–‡ä»¶æ–¹å¼æ–°å»ºé…ç½®å¯¹è±¡</span></span><br><span class=\"line\"></span><br><span class=\"line\">co.set_browser_path(<span class=\"string\">r&#x27;C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe&#x27;</span>)  <span class=\"comment\"># è®¾ç½®æµè§ˆå™¨è·¯å¾„</span></span><br><span class=\"line\"><span class=\"comment\"># co.set_argument(&#x27;--headless&#x27;)  # è®¾ç½®æ— å¤´æ¨¡å¼ éšè—æµè§ˆå™¨ç•Œé¢</span></span><br><span class=\"line\"><span class=\"comment\"># è®¾ç½®é…ç½®æ–‡ä»¶è·¯å¾„</span></span><br><span class=\"line\">co.set_user_data_path(<span class=\"string\">r&#x27;C:\\Users\\weiek\\AppData\\Local\\Google\\Chrome\\User Data&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">url_base = <span class=\"string\">&quot;https://www.wenext.cn/index.php?route=account/order&amp;filter_time=6&amp;page=&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">page = ChromiumPage(co)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># cp = ChromiumPage(co)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">1</span>, <span class=\"number\">20</span>):</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(i)</span><br><span class=\"line\">    url = url_base + <span class=\"built_in\">str</span>(i)</span><br><span class=\"line\">    page.get(url)</span><br><span class=\"line\">    <span class=\"comment\"># ç­‰å¾…é¡µé¢åŠ è½½å®Œæˆ</span></span><br><span class=\"line\">    page.wait.doc_loaded()</span><br><span class=\"line\">    <span class=\"comment\"># ä» page.html æ­£åˆ™åŒ¹é…è®¢å•å· è®¢å•ç¼–å· 86027961</span></span><br><span class=\"line\">    result_num = re.findall(<span class=\"string\">r&#x27;è®¢å•ç¼–å· (\\d+)&#x27;</span>, page.html)</span><br><span class=\"line\">    <span class=\"comment\"># print(result_num)</span></span><br><span class=\"line\">    <span class=\"keyword\">try</span>:</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> result_num:</span><br><span class=\"line\">            page.get(<span class=\"string\">&#x27;https://www.wenext.cn/index.php?route=account/order/info&amp;order_id=&#x27;</span> + i)</span><br><span class=\"line\">            page.wait.doc_loaded()</span><br><span class=\"line\">            <span class=\"comment\"># print(page.html)</span></span><br><span class=\"line\">            <span class=\"comment\"># æ­£åˆ™åŒ¹é…è®¢å•é‡‘é¢ ä½™é¢(158.00) ä½™é¢(158)</span></span><br><span class=\"line\">            result_money = re.findall(<span class=\"string\">r&#x27;ä½™é¢\\((.*?)\\)&#x27;</span>, page.html)[<span class=\"number\">0</span>]</span><br><span class=\"line\">            <span class=\"built_in\">print</span>(result_money)</span><br><span class=\"line\">            <span class=\"comment\"># time.sleep(10)</span></span><br><span class=\"line\">            <span class=\"comment\"># æ­£åˆ™åŒ¹é¢„è®¡åœ¨2024-03-17 23:00:00å‰å‘è´§</span></span><br><span class=\"line\">            result_time1 = re.findall(<span class=\"string\">r&#x27;é¢„è®¡åœ¨(.*?)å‰å‘è´§&#x27;</span>, page.html)[<span class=\"number\">0</span>].replace(<span class=\"string\">&#x27;23:00:00&#x27;</span>, <span class=\"string\">&#x27; &#x27;</span>)</span><br><span class=\"line\">            <span class=\"built_in\">print</span>(result_time1)</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\"># æ­£åˆ™åŒ¹é…                   &lt;td class=&quot;order-body-time&quot;&gt;2024-03-10&lt;/td&gt;</span></span><br><span class=\"line\">    <span class=\"comment\"># &lt;td class=&quot;order-body-time&quot;&gt;2024-03-10&lt;/td&gt;</span></span><br><span class=\"line\">    <span class=\"comment\"># &lt;td class=&quot;order-body-time&quot;&gt;å·²å‘è´§ï¼Œå¾…ç­¾æ”¶&lt;/td&gt;</span></span><br><span class=\"line\">            result_time2_list = re.findall(<span class=\"string\">r&#x27;&lt;td class=&quot;order-body-time&quot;&gt;(.*?)&lt;/td&gt;&#x27;</span>, page.html, re.S)</span><br><span class=\"line\">            result_time2 = <span class=\"string\">&#x27;0&#x27;</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> result_time2_list:</span><br><span class=\"line\">                <span class=\"keyword\">if</span> j == <span class=\"string\">&#x27;å·²å‘è´§ï¼Œå¾…ç­¾æ”¶&#x27;</span>:</span><br><span class=\"line\">                    <span class=\"comment\"># è·å–ç´¢å¼•</span></span><br><span class=\"line\">                    index = result_time2_list.index(j)</span><br><span class=\"line\">                    <span class=\"comment\"># è·å–å‘è´§æ—¶é—´</span></span><br><span class=\"line\">                    result_time2 = result_time2_list[index - <span class=\"number\">1</span>]</span><br><span class=\"line\">            <span class=\"keyword\">if</span> result_time2 != <span class=\"string\">&#x27;0&#x27;</span>:</span><br><span class=\"line\">                <span class=\"keyword\">with</span> <span class=\"built_in\">open</span>(<span class=\"string\">&#x27;wenext.txt&#x27;</span>, <span class=\"string\">&#x27;a&#x27;</span>) <span class=\"keyword\">as</span> f: </span><br><span class=\"line\">                    <span class=\"comment\"># å†™å…¥æ–‡ä»¶ è®¢å•å· è®¢å•é‡‘é¢ é¢„è®¡å‘è´§æ—¶é—´  å®é™…å‘è´§æ—¶é—´</span></span><br><span class=\"line\">                    f.write(i + <span class=\"string\">&#x27;\t&#x27;</span> + result_money + <span class=\"string\">&#x27;\t&#x27;</span> + result_time1 + <span class=\"string\">&#x27;\t&#x27;</span> + result_time2 + <span class=\"string\">&#x27;    &#x27;</span>+<span class=\"string\">&#x27;\\n&#x27;</span>)</span><br><span class=\"line\">            <span class=\"built_in\">print</span>(result_time2)</span><br><span class=\"line\">            <span class=\"comment\"># time.sleep(1)</span></span><br><span class=\"line\">    <span class=\"keyword\">except</span>:</span><br><span class=\"line\">        <span class=\"keyword\">with</span> <span class=\"built_in\">open</span>(<span class=\"string\">&#x27;wenexterr.txt&#x27;</span>, <span class=\"string\">&#x27;a&#x27;</span>) <span class=\"keyword\">as</span> f: </span><br><span class=\"line\">            f.write(i + <span class=\"string\">&#x27;\t&#x27;</span> + <span class=\"string\">&#x27;error&#x27;</span> + <span class=\"string\">&#x27;\t&#x27;</span> + <span class=\"string\">&#x27;error&#x27;</span> + <span class=\"string\">&#x27;\t&#x27;</span> + <span class=\"string\">&#x27;error&#x27;</span> + <span class=\"string\">&#x27;    &#x27;</span>+<span class=\"string\">&#x27;\\n&#x27;</span>)</span><br></pre></td></tr></table></figure>\n\n","more":"<h2 id=\"DrissionPage-æ˜¯ä»€ä¹ˆ\"><a href=\"#DrissionPage-æ˜¯ä»€ä¹ˆ\" class=\"headerlink\" title=\"DrissionPage æ˜¯ä»€ä¹ˆ\"></a>DrissionPage æ˜¯ä»€ä¹ˆ</h2><p>DrissionPage æ˜¯ä¸€ä¸ªåŸºäº python çš„ç½‘é¡µè‡ªåŠ¨åŒ–å·¥å…·ã€‚<br>å®ƒæ—¢èƒ½æ§åˆ¶æµè§ˆå™¨ï¼Œä¹Ÿèƒ½æ”¶å‘æ•°æ®åŒ…ï¼Œè¿˜èƒ½æŠŠä¸¤è€…åˆè€Œä¸ºä¸€ã€‚<br>å¯å…¼é¡¾æµè§ˆå™¨è‡ªåŠ¨åŒ–çš„ä¾¿åˆ©æ€§å’Œ requests çš„é«˜æ•ˆç‡ã€‚<br>å®ƒåŠŸèƒ½å¼ºå¤§ï¼Œå†…ç½®æ— æ•°äººæ€§åŒ–è®¾è®¡å’Œä¾¿æ·åŠŸèƒ½ã€‚<br>å®ƒçš„è¯­æ³•ç®€æ´è€Œä¼˜é›…ï¼Œä»£ç é‡å°‘ï¼Œå¯¹æ–°æ‰‹å‹å¥½ã€‚</p>\n<p>ç”¨ requests åšæ•°æ®é‡‡é›†é¢å¯¹è¦ç™»å½•çš„ç½‘ç«™æ—¶ï¼Œè¦åˆ†ææ•°æ®åŒ…ã€JS æºç ï¼Œæ„é€ å¤æ‚çš„è¯·æ±‚ï¼Œå¾€å¾€è¿˜è¦åº”ä»˜éªŒè¯ç ã€JS æ··æ·†ã€ç­¾åå‚æ•°ç­‰åçˆ¬æ‰‹æ®µï¼Œé—¨æ§›è¾ƒé«˜ï¼Œå¼€å‘æ•ˆç‡ä¸é«˜ã€‚ä½¿ç”¨æµè§ˆå™¨ï¼Œå¯ä»¥å¾ˆå¤§ç¨‹åº¦ä¸Šç»•è¿‡è¿™äº›å‘ï¼Œä½†æµè§ˆå™¨è¿è¡Œæ•ˆç‡ä¸é«˜ã€‚</p>\n<p>å› æ­¤ï¼Œè¿™ä¸ªåº“è®¾è®¡åˆè¡·ï¼Œæ˜¯å°†å®ƒä»¬åˆè€Œä¸ºä¸€ï¼ŒåŒæ—¶å®ç°â€œå†™å¾—å¿«â€å’Œâ€œè·‘å¾—å¿«â€ã€‚èƒ½å¤Ÿåœ¨ä¸åŒéœ€è¦æ—¶åˆ‡æ¢ç›¸åº”æ¨¡å¼ï¼Œå¹¶æä¾›ä¸€ç§äººæ€§åŒ–çš„ä½¿ç”¨æ–¹æ³•ï¼Œæé«˜å¼€å‘å’Œè¿è¡Œæ•ˆç‡ã€‚<br>é™¤äº†åˆå¹¶ä¸¤è€…ï¼Œæœ¬åº“è¿˜ä»¥ç½‘é¡µä¸ºå•ä½å°è£…äº†å¸¸ç”¨åŠŸèƒ½ï¼Œæä¾›éå¸¸ç®€ä¾¿çš„æ“ä½œå’Œè¯­å¥ï¼Œä½¿ç”¨æˆ·å¯å‡å°‘è€ƒè™‘ç»†èŠ‚ï¼Œä¸“æ³¨åŠŸèƒ½å®ç°ã€‚ ä»¥ç®€å•çš„æ–¹å¼å®ç°å¼ºå¤§çš„åŠŸèƒ½ï¼Œä½¿ä»£ç æ›´ä¼˜é›…ã€‚</p>\n<p>ä»¥å‰çš„ç‰ˆæœ¬æ˜¯å¯¹ selenium è¿›è¡Œé‡æ–°å°è£…å®ç°çš„ã€‚ä» 3.0 å¼€å§‹ï¼Œä½œè€…å¦èµ·ç‚‰ç¶ï¼Œå¯¹åº•å±‚è¿›è¡Œäº†é‡æ–°å¼€å‘ï¼Œæ‘†è„±å¯¹ selenium çš„ä¾èµ–ï¼Œå¢å¼ºäº†åŠŸèƒ½ï¼Œæå‡äº†è¿è¡Œæ•ˆç‡ã€‚</p>\n<h2 id=\"ç¤ºä¾‹ä»£ç \"><a href=\"#ç¤ºä¾‹ä»£ç \" class=\"headerlink\" title=\"ç¤ºä¾‹ä»£ç \"></a>ç¤ºä¾‹ä»£ç </h2><figure class=\"highlight nsis\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from DrissionPage import ChromiumPage</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ›å»ºé¡µé¢å¯¹è±¡ï¼Œå¹¶å¯åŠ¨æˆ–æ¥ç®¡æµè§ˆå™¨</span></span><br><span class=\"line\"><span class=\"keyword\">page</span> = ChromiumPage()</span><br><span class=\"line\"><span class=\"comment\"># è·³è½¬åˆ°ç™»å½•é¡µé¢</span></span><br><span class=\"line\"><span class=\"keyword\">page</span>.get(<span class=\"string\">&#x27;https://gitee.com/login&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å®šä½åˆ°è´¦å·æ–‡æœ¬æ¡†ï¼Œè·å–æ–‡æœ¬æ¡†å…ƒç´ </span></span><br><span class=\"line\">ele = <span class=\"keyword\">page</span>.ele(<span class=\"string\">&#x27;#user_login&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\"># è¾“å…¥å¯¹æ–‡æœ¬æ¡†è¾“å…¥è´¦å·</span></span><br><span class=\"line\">ele.input(<span class=\"string\">&#x27;æ‚¨çš„è´¦å·&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\"># å®šä½åˆ°å¯†ç æ–‡æœ¬æ¡†å¹¶è¾“å…¥å¯†ç </span></span><br><span class=\"line\"><span class=\"keyword\">page</span>.ele(<span class=\"string\">&#x27;#user_password&#x27;</span>).input(<span class=\"string\">&#x27;æ‚¨çš„å¯†ç &#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\"># ç‚¹å‡»ç™»å½•æŒ‰é’®</span></span><br><span class=\"line\"><span class=\"keyword\">page</span>.ele(<span class=\"string\">&#x27;@value=ç™» å½•&#x27;</span>).click()</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"åº”ç”¨å®ä¾‹\"><a href=\"#åº”ç”¨å®ä¾‹\" class=\"headerlink\" title=\"åº”ç”¨å®ä¾‹\"></a>åº”ç”¨å®ä¾‹</h2><h3 id=\"æ·˜å®å•†å“æˆªå›¾\"><a href=\"#æ·˜å®å•†å“æˆªå›¾\" class=\"headerlink\" title=\"æ·˜å®å•†å“æˆªå›¾\"></a>æ·˜å®å•†å“æˆªå›¾</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># éƒ¨åˆ†ä»£ç </span></span><br><span class=\"line\">page = ChromiumPage(co)</span><br><span class=\"line\">page.get(img_url,retry=<span class=\"number\">1</span>, interval=<span class=\"number\">1</span>, timeout=<span class=\"number\">1.5</span>)</span><br><span class=\"line\">                </span><br><span class=\"line\">img = page(<span class=\"string\">&#x27;tag:img&#x27;</span>)</span><br><span class=\"line\">img.get_screenshot(path=<span class=\"string\">&#x27;./&#x27;</span>, name=<span class=\"string\">&#x27;temp_img.jpg&#x27;</span>)</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"æœªæ¥å·¥å‚è®¢å•æ•°æ®çˆ¬å–\"><a href=\"#æœªæ¥å·¥å‚è®¢å•æ•°æ®çˆ¬å–\" class=\"headerlink\" title=\"æœªæ¥å·¥å‚è®¢å•æ•°æ®çˆ¬å–\"></a>æœªæ¥å·¥å‚è®¢å•æ•°æ®çˆ¬å–</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> DrissionPage <span class=\"keyword\">import</span> SessionPage, SessionOptions <span class=\"comment\"># pip install DrissionPage</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> DrissionPage <span class=\"keyword\">import</span> ChromiumPage</span><br><span class=\"line\"><span class=\"keyword\">from</span> DrissionPage <span class=\"keyword\">import</span> ChromiumOptions</span><br><span class=\"line\"><span class=\"keyword\">import</span> re</span><br><span class=\"line\"><span class=\"keyword\">import</span> time</span><br><span class=\"line\"></span><br><span class=\"line\">co = ChromiumOptions(read_file=<span class=\"literal\">False</span>)  <span class=\"comment\"># ä¸è¯»å–æ–‡ä»¶æ–¹å¼æ–°å»ºé…ç½®å¯¹è±¡</span></span><br><span class=\"line\"></span><br><span class=\"line\">co.set_browser_path(<span class=\"string\">r&#x27;C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe&#x27;</span>)  <span class=\"comment\"># è®¾ç½®æµè§ˆå™¨è·¯å¾„</span></span><br><span class=\"line\"><span class=\"comment\"># co.set_argument(&#x27;--headless&#x27;)  # è®¾ç½®æ— å¤´æ¨¡å¼ éšè—æµè§ˆå™¨ç•Œé¢</span></span><br><span class=\"line\"><span class=\"comment\"># è®¾ç½®é…ç½®æ–‡ä»¶è·¯å¾„</span></span><br><span class=\"line\">co.set_user_data_path(<span class=\"string\">r&#x27;C:\\Users\\weiek\\AppData\\Local\\Google\\Chrome\\User Data&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">url_base = <span class=\"string\">&quot;https://www.wenext.cn/index.php?route=account/order&amp;filter_time=6&amp;page=&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">page = ChromiumPage(co)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># cp = ChromiumPage(co)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">1</span>, <span class=\"number\">20</span>):</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(i)</span><br><span class=\"line\">    url = url_base + <span class=\"built_in\">str</span>(i)</span><br><span class=\"line\">    page.get(url)</span><br><span class=\"line\">    <span class=\"comment\"># ç­‰å¾…é¡µé¢åŠ è½½å®Œæˆ</span></span><br><span class=\"line\">    page.wait.doc_loaded()</span><br><span class=\"line\">    <span class=\"comment\"># ä» page.html æ­£åˆ™åŒ¹é…è®¢å•å· è®¢å•ç¼–å· 86027961</span></span><br><span class=\"line\">    result_num = re.findall(<span class=\"string\">r&#x27;è®¢å•ç¼–å· (\\d+)&#x27;</span>, page.html)</span><br><span class=\"line\">    <span class=\"comment\"># print(result_num)</span></span><br><span class=\"line\">    <span class=\"keyword\">try</span>:</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> result_num:</span><br><span class=\"line\">            page.get(<span class=\"string\">&#x27;https://www.wenext.cn/index.php?route=account/order/info&amp;order_id=&#x27;</span> + i)</span><br><span class=\"line\">            page.wait.doc_loaded()</span><br><span class=\"line\">            <span class=\"comment\"># print(page.html)</span></span><br><span class=\"line\">            <span class=\"comment\"># æ­£åˆ™åŒ¹é…è®¢å•é‡‘é¢ ä½™é¢(158.00) ä½™é¢(158)</span></span><br><span class=\"line\">            result_money = re.findall(<span class=\"string\">r&#x27;ä½™é¢\\((.*?)\\)&#x27;</span>, page.html)[<span class=\"number\">0</span>]</span><br><span class=\"line\">            <span class=\"built_in\">print</span>(result_money)</span><br><span class=\"line\">            <span class=\"comment\"># time.sleep(10)</span></span><br><span class=\"line\">            <span class=\"comment\"># æ­£åˆ™åŒ¹é¢„è®¡åœ¨2024-03-17 23:00:00å‰å‘è´§</span></span><br><span class=\"line\">            result_time1 = re.findall(<span class=\"string\">r&#x27;é¢„è®¡åœ¨(.*?)å‰å‘è´§&#x27;</span>, page.html)[<span class=\"number\">0</span>].replace(<span class=\"string\">&#x27;23:00:00&#x27;</span>, <span class=\"string\">&#x27; &#x27;</span>)</span><br><span class=\"line\">            <span class=\"built_in\">print</span>(result_time1)</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\"># æ­£åˆ™åŒ¹é…                   &lt;td class=&quot;order-body-time&quot;&gt;2024-03-10&lt;/td&gt;</span></span><br><span class=\"line\">    <span class=\"comment\"># &lt;td class=&quot;order-body-time&quot;&gt;2024-03-10&lt;/td&gt;</span></span><br><span class=\"line\">    <span class=\"comment\"># &lt;td class=&quot;order-body-time&quot;&gt;å·²å‘è´§ï¼Œå¾…ç­¾æ”¶&lt;/td&gt;</span></span><br><span class=\"line\">            result_time2_list = re.findall(<span class=\"string\">r&#x27;&lt;td class=&quot;order-body-time&quot;&gt;(.*?)&lt;/td&gt;&#x27;</span>, page.html, re.S)</span><br><span class=\"line\">            result_time2 = <span class=\"string\">&#x27;0&#x27;</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> result_time2_list:</span><br><span class=\"line\">                <span class=\"keyword\">if</span> j == <span class=\"string\">&#x27;å·²å‘è´§ï¼Œå¾…ç­¾æ”¶&#x27;</span>:</span><br><span class=\"line\">                    <span class=\"comment\"># è·å–ç´¢å¼•</span></span><br><span class=\"line\">                    index = result_time2_list.index(j)</span><br><span class=\"line\">                    <span class=\"comment\"># è·å–å‘è´§æ—¶é—´</span></span><br><span class=\"line\">                    result_time2 = result_time2_list[index - <span class=\"number\">1</span>]</span><br><span class=\"line\">            <span class=\"keyword\">if</span> result_time2 != <span class=\"string\">&#x27;0&#x27;</span>:</span><br><span class=\"line\">                <span class=\"keyword\">with</span> <span class=\"built_in\">open</span>(<span class=\"string\">&#x27;wenext.txt&#x27;</span>, <span class=\"string\">&#x27;a&#x27;</span>) <span class=\"keyword\">as</span> f: </span><br><span class=\"line\">                    <span class=\"comment\"># å†™å…¥æ–‡ä»¶ è®¢å•å· è®¢å•é‡‘é¢ é¢„è®¡å‘è´§æ—¶é—´  å®é™…å‘è´§æ—¶é—´</span></span><br><span class=\"line\">                    f.write(i + <span class=\"string\">&#x27;\t&#x27;</span> + result_money + <span class=\"string\">&#x27;\t&#x27;</span> + result_time1 + <span class=\"string\">&#x27;\t&#x27;</span> + result_time2 + <span class=\"string\">&#x27;    &#x27;</span>+<span class=\"string\">&#x27;\\n&#x27;</span>)</span><br><span class=\"line\">            <span class=\"built_in\">print</span>(result_time2)</span><br><span class=\"line\">            <span class=\"comment\"># time.sleep(1)</span></span><br><span class=\"line\">    <span class=\"keyword\">except</span>:</span><br><span class=\"line\">        <span class=\"keyword\">with</span> <span class=\"built_in\">open</span>(<span class=\"string\">&#x27;wenexterr.txt&#x27;</span>, <span class=\"string\">&#x27;a&#x27;</span>) <span class=\"keyword\">as</span> f: </span><br><span class=\"line\">            f.write(i + <span class=\"string\">&#x27;\t&#x27;</span> + <span class=\"string\">&#x27;error&#x27;</span> + <span class=\"string\">&#x27;\t&#x27;</span> + <span class=\"string\">&#x27;error&#x27;</span> + <span class=\"string\">&#x27;\t&#x27;</span> + <span class=\"string\">&#x27;error&#x27;</span> + <span class=\"string\">&#x27;    &#x27;</span>+<span class=\"string\">&#x27;\\n&#x27;</span>)</span><br></pre></td></tr></table></figure>\n\n","categories":[{"name":"ğŸ’»Code","path":"api/categories/ğŸ’»Code.json"}],"tags":[{"name":"ğŸ’»Code","path":"api/tags/ğŸ’»Code.json"},{"name":"ğŸ•·ï¸Python","path":"api/tags/ğŸ•·ï¸Python.json"}]}
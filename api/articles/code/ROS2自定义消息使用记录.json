{"title":"ROS2è‡ªå®šä¹‰æ¶ˆæ¯ä½¿ç”¨è®°å½•","slug":"code/ROS2è‡ªå®šä¹‰æ¶ˆæ¯ä½¿ç”¨è®°å½•","date":"2023-04-01T15:35:11.000Z","updated":"2023-04-01T15:35:11.000Z","comments":true,"path":"api/articles/code/ROS2è‡ªå®šä¹‰æ¶ˆæ¯ä½¿ç”¨è®°å½•.json","excerpt":null,"covers":null,"content":"<h2 id=\"èµ·å› \"><a href=\"#èµ·å› \" class=\"headerlink\" title=\"èµ·å› \"></a>èµ·å› </h2><p>æœ€è¿‘åœ¨åšäººä½“å§¿æ€ä¼°è®¡çš„é¡¹ç›®,éœ€è¦ç”¨åˆ°ROS2,ä½†æ˜¯ROS2çš„æ¶ˆæ¯ç±»å‹ä¸å¤Ÿç”¨,æ‰€ä»¥éœ€è¦è‡ªå®šä¹‰æ¶ˆæ¯ç±»å‹,è¿™é‡Œè®°å½•ä¸€ä¸‹è‡ªå®šä¹‰æ¶ˆæ¯ç±»å‹çš„è¿‡ç¨‹.</p>\n<p>ä½¿ç”¨çš„å·¥å…·å¦‚ä¸‹</p>\n<ul>\n<li>ROS2 Humble</li>\n<li>VSCode</li>\n<li>Alphapose</li>\n</ul>\n<p>ä¹‹å‰è·Ÿç€å®˜æ–¹æ–‡æ¡£åšè¿‡ä¸€æ¬¡,ä½†æ˜¯å­¦ä¼šäº†,ä½†åˆæ²¡å­¦ä¼š.è¿™æ¬¡æ˜¯çœŸçš„è¦ç”¨,åè€Œå‡ºé—®é¢˜äº†.</p>\n<h2 id=\"è‡ªå®šä¹‰æ¶ˆæ¯ç±»å‹\"><a href=\"#è‡ªå®šä¹‰æ¶ˆæ¯ç±»å‹\" class=\"headerlink\" title=\"è‡ªå®šä¹‰æ¶ˆæ¯ç±»å‹\"></a>è‡ªå®šä¹‰æ¶ˆæ¯ç±»å‹</h2><p>ä¹‹å‰ä»¥ä¸ºæ¯ä¸ªåŒ…é‡Œé¢éƒ½å¯ä»¥è‡ªå®šä¹‰æ¶ˆæ¯,ä½†æ˜¯æƒ³å¤šäº†,éœ€è¦ç‹¬ç«‹çš„åŒ…æ¥å­˜æ”¾è‡ªå®šä¹‰æ¶ˆæ¯.</p>\n<h3 id=\"åˆ›å»ºåŒ…\"><a href=\"#åˆ›å»ºåŒ…\" class=\"headerlink\" title=\"åˆ›å»ºåŒ…\"></a>åˆ›å»ºåŒ…</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ros2 pkg create --build-type ament_python --node-name people_msgs people_msgs</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"åˆ›å»ºæ¶ˆæ¯\"><a href=\"#åˆ›å»ºæ¶ˆæ¯\" class=\"headerlink\" title=\"åˆ›å»ºæ¶ˆæ¯\"></a>åˆ›å»ºæ¶ˆæ¯</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Point.msg</span></span><br><span class=\"line\">float32 x</span><br><span class=\"line\">float32 y</span><br><span class=\"line\">float32 z</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># People.msg ä»¥ä¸ºäººä½“å…³é”®ç‚¹æ˜¯26ä¸ª,æ‰€ä»¥è¿™é‡Œå°±å†™26ä¸ª,ä½†æ˜¯åé¢å‘ç°å‡ºäº†é—®é¢˜</span></span><br><span class=\"line\">Point[26] keypoints</span><br></pre></td></tr></table></figure>\n<p>è®°ä½è¿™ä¸ª26,é—®é¢˜å°±å‡ºåœ¨è¿™é‡Œ.</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># PeopleArray.msg</span></span><br><span class=\"line\">People[] people</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"ç¼–è¯‘\"><a href=\"#ç¼–è¯‘\" class=\"headerlink\" title=\"ç¼–è¯‘\"></a>ç¼–è¯‘</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">colcon build --packages-select people_msgs</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"ä½¿ç”¨\"><a href=\"#ä½¿ç”¨\" class=\"headerlink\" title=\"ä½¿ç”¨\"></a>ä½¿ç”¨</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">source</span> install/setup.bash</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"ä½¿ç”¨è‡ªå®šä¹‰æ¶ˆæ¯\"><a href=\"#ä½¿ç”¨è‡ªå®šä¹‰æ¶ˆæ¯\" class=\"headerlink\" title=\"ä½¿ç”¨è‡ªå®šä¹‰æ¶ˆæ¯\"></a>ä½¿ç”¨è‡ªå®šä¹‰æ¶ˆæ¯</h2><h3 id=\"åˆ›å»ºåŒ…-1\"><a href=\"#åˆ›å»ºåŒ…-1\" class=\"headerlink\" title=\"åˆ›å»ºåŒ…\"></a>åˆ›å»ºåŒ…</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ros2 pkg create --build-type ament_python --node-name people_sub people_sub</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"ç¼–å†™ä»£ç \"><a href=\"#ç¼–å†™ä»£ç \" class=\"headerlink\" title=\"ç¼–å†™ä»£ç \"></a>ç¼–å†™ä»£ç </h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># people_sub.py</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> rclpy</span><br><span class=\"line\"><span class=\"keyword\">from</span> rclpy.node <span class=\"keyword\">import</span> Node</span><br><span class=\"line\"><span class=\"keyword\">from</span> people_msgs.msg <span class=\"keyword\">import</span> PeopleArray</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">PeopleSub</span>(<span class=\"title class_ inherited__\">Node</span>):</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self</span>):</span><br><span class=\"line\">        <span class=\"built_in\">super</span>().__init__(<span class=\"string\">&#x27;people_sub&#x27;</span>)</span><br><span class=\"line\">        self.sub = self.create_subscription(PeopleArray, <span class=\"string\">&#x27;people&#x27;</span>, self.people_callback, <span class=\"number\">10</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">people_callback</span>(<span class=\"params\">self, msg</span>):</span><br><span class=\"line\">        self.get_logger().info(<span class=\"string\">&#x27;I heard: %s&#x27;</span> % msg)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">getnode</span>(<span class=\"params\">self</span>): <span class=\"comment\"># å‡å¦‚è¯´è¿™æ˜¯è¯†åˆ«åå¤„ç†å…³é”®ç‚¹çš„å‡½æ•°</span></span><br><span class=\"line\">        peoplearray = PeopleArray()</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> peoplelist: <span class=\"comment\"># å‡å¦‚è¯´è¿™æ˜¯è¯†åˆ«åæ‰€æœ‰äººçš„åˆ—è¡¨</span></span><br><span class=\"line\">            people = People()</span><br><span class=\"line\">            <span class=\"comment\"># people.keypoints.clear() # è¿™é‡Œæ˜¯å…³é”®,ä¸ç„¶ä¼šå‡ºé—®é¢˜</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> i: <span class=\"comment\">#æ¯ä¸ªäººèº«ä¸Šçš„å…³é”®ç‚¹</span></span><br><span class=\"line\">                point = Point()</span><br><span class=\"line\">                point.x = j[<span class=\"number\">0</span>]</span><br><span class=\"line\">                point.y = j[<span class=\"number\">1</span>]</span><br><span class=\"line\">                point.z = j[<span class=\"number\">2</span>]</span><br><span class=\"line\">                people.keypoints.append(point)</span><br><span class=\"line\">            peoplearray.people.append(people)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> peoplearray</span><br><span class=\"line\">        </span><br><span class=\"line\">                </span><br><span class=\"line\">                </span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">return</span> self</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">main</span>(<span class=\"params\">args=<span class=\"literal\">None</span></span>):</span><br><span class=\"line\">    rclpy.init(args=args)</span><br><span class=\"line\">    people_sub = PeopleSub()</span><br><span class=\"line\">    rclpy.spin(people_sub)</span><br><span class=\"line\">    people_sub.destroy_node()</span><br><span class=\"line\">    rclpy.shutdown()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">&#x27;__main__&#x27;</span>:</span><br><span class=\"line\">    main()</span><br></pre></td></tr></table></figure>\n<h3 id=\"ç¼–è¯‘-1\"><a href=\"#ç¼–è¯‘-1\" class=\"headerlink\" title=\"ç¼–è¯‘\"></a>ç¼–è¯‘</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">colcon build --packages-select people_sub</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"ä½¿ç”¨-1\"><a href=\"#ä½¿ç”¨-1\" class=\"headerlink\" title=\"ä½¿ç”¨\"></a>ä½¿ç”¨</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">source</span> install/setup.bash</span><br><span class=\"line\">ros2 run people_sub people_sub</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"é—®é¢˜\"><a href=\"#é—®é¢˜\" class=\"headerlink\" title=\"é—®é¢˜\"></a>é—®é¢˜</h2><p>æˆ‘ä½¿ç”¨è‡ªå®šä¹‰æ¶ˆæ¯è¿›è¡Œæ¥æ”¶,å‘ç°æ¥æ”¶åˆ°çš„æ¶ˆæ¯æ˜¯ç©ºçš„,åæ¥å‘ç°æ˜¯å› ä¸ºæˆ‘åœ¨åˆ›å»ºæ¶ˆæ¯çš„æ—¶å€™,å®ƒä¼šé»˜è®¤åˆ›å»ºä¸€ä¸ªç©ºçš„æ¶ˆæ¯(26ä¸ªæ•°æ®éƒ½æ˜¯0),æ‰€ä»¥æˆ‘åœ¨åˆ›å»ºæ¶ˆæ¯çš„æ—¶å€™,éœ€è¦å…ˆæ¸…ç©ºæ¶ˆæ¯,ç„¶åå†æ·»åŠ æ•°æ®.</p>\n<h2 id=\"æ„Ÿæ‚Ÿ\"><a href=\"#æ„Ÿæ‚Ÿ\" class=\"headerlink\" title=\"æ„Ÿæ‚Ÿ\"></a>æ„Ÿæ‚Ÿ</h2><p>æœç„¶<em>å®è·µæ˜¯æ£€éªŒçœŸç†çš„å”¯ä¸€æ ‡å‡†</em></p>\n<p>è¿™æ¬¡çš„é—®é¢˜æ˜¯å•æ­¥è°ƒè¯•å‡ºæ¥çš„,è°ƒè¯•ä¹‹å‰å¤„ç†äº†pythonè·¯å¾„çš„é—®é¢˜,ä¸ç„¶æ— æ³•ä½¿ç”¨VSCodeè°ƒè¯•.</p>\n<h3 id=\"pythonæ‰©å±•è·¯å¾„é—®é¢˜\"><a href=\"#pythonæ‰©å±•è·¯å¾„é—®é¢˜\" class=\"headerlink\" title=\"pythonæ‰©å±•è·¯å¾„é—®é¢˜\"></a>pythonæ‰©å±•è·¯å¾„é—®é¢˜</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1.é€šè¿‡è„šæœ¬æŸ¥çœ‹pythonè·¯å¾„</span></span><br><span class=\"line\">python -c <span class=\"string\">&quot;import sys; print(sys.path)&quot;</span></span><br></pre></td></tr></table></figure>\n\n<p>è®¾ç½®ç¯å¢ƒvscodeè·¯å¾„</p>\n<p>Pythonæ‰©å±• è®¾ç½® -&gt; Pythoninterpreter Path -&gt; (&#x2F;usr&#x2F;bin&#x2F;python3)æ¢æˆä¸Šä¸€æ­¥çš„è·¯å¾„å³å¯è§£å†³</p>\n<p>è¿˜æœ‰ä¸ªé—®é¢˜æˆ‘é—®äº†ä¸‹GPT</p>\n<h3 id=\"ROS2ä½¿ç”¨è‡ªå®šä¹‰Pythonè§£é‡Šå™¨\"><a href=\"#ROS2ä½¿ç”¨è‡ªå®šä¹‰Pythonè§£é‡Šå™¨\" class=\"headerlink\" title=\"ROS2ä½¿ç”¨è‡ªå®šä¹‰Pythonè§£é‡Šå™¨\"></a>ROS2ä½¿ç”¨è‡ªå®šä¹‰Pythonè§£é‡Šå™¨</h3><p>è¦æŒ‡å®šROS 2ä½¿ç”¨çš„Pythonè§£é‡Šå™¨ï¼Œæ‚¨å¯ä»¥è®¾ç½®ç¯å¢ƒå˜é‡PYTHON_EXECUTABLEï¼Œå°†å…¶è®¾ç½®ä¸ºè¦ä½¿ç”¨çš„Pythonè§£é‡Šå™¨çš„è·¯å¾„ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æ‚¨çš„è‡ªå®šä¹‰Pythonè§£é‡Šå™¨ä½äº&#x2F;path&#x2F;to&#x2F;my&#x2F;pythonï¼Œåˆ™å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åœ¨ç»ˆç«¯ä¸­è®¾ç½®ç¯å¢ƒå˜é‡ï¼š</p>\n<p><code>export PYTHON_EXECUTABLE=/path/to/my/python</code></p>\n<p>è®¾ç½®ç¯å¢ƒå˜é‡åï¼ŒROS 2å°†ä½¿ç”¨æŒ‡å®šçš„Pythonè§£é‡Šå™¨ã€‚æ‚¨å¯ä»¥åœ¨å¯åŠ¨ROS 2èŠ‚ç‚¹æ—¶éªŒè¯Pythonè§£é‡Šå™¨æ˜¯å¦æ­£ç¡®è®¾ç½®ï¼Œä¾‹å¦‚ï¼š</p>\n<p><code>ros2 run my_package my_node --ros-args --log-level debug</code></p>\n<p>è¿™å°†åœ¨ç»ˆç«¯è¾“å‡ºROS 2èŠ‚ç‚¹çš„æ—¥å¿—ä¿¡æ¯ï¼Œå…¶ä¸­åŒ…æ‹¬ä½¿ç”¨çš„Pythonè§£é‡Šå™¨ã€‚å¦‚æœæ‚¨çœ‹åˆ°çš„è¾“å‡ºä¸­åŒ…å«æ‚¨è‡ªå®šä¹‰çš„Pythonè§£é‡Šå™¨è·¯å¾„ï¼Œåˆ™è¡¨ç¤ºROS 2æ­£åœ¨ä½¿ç”¨æŒ‡å®šçš„Pythonè§£é‡Šå™¨ã€‚</p>\n<p>æ³¨æ„ï¼Œè®¾ç½®è‡ªå®šä¹‰Pythonè§£é‡Šå™¨å¯èƒ½ä¼šå¯¼è‡´ROS 2æŸäº›åŠŸèƒ½æ— æ³•æ­£å¸¸å·¥ä½œï¼Œå› ä¸ºROS 2å¯èƒ½ä¾èµ–äºç‰¹å®šç‰ˆæœ¬çš„Pythonå’ŒPythonåº“ã€‚å¦‚æœæ‚¨é‡åˆ°é—®é¢˜ï¼Œè¯·å°è¯•ä½¿ç”¨ROS 2é»˜è®¤çš„Pythonè§£é‡Šå™¨ï¼Œæˆ–è€…ç¡®ä¿æ‚¨çš„è‡ªå®šä¹‰Pythonè§£é‡Šå™¨ä¸ROS 2æ‰€éœ€çš„Pythonç‰ˆæœ¬å’Œåº“å…¼å®¹ã€‚</p>\n","more":"<h2 id=\"èµ·å› \"><a href=\"#èµ·å› \" class=\"headerlink\" title=\"èµ·å› \"></a>èµ·å› </h2><p>æœ€è¿‘åœ¨åšäººä½“å§¿æ€ä¼°è®¡çš„é¡¹ç›®,éœ€è¦ç”¨åˆ°ROS2,ä½†æ˜¯ROS2çš„æ¶ˆæ¯ç±»å‹ä¸å¤Ÿç”¨,æ‰€ä»¥éœ€è¦è‡ªå®šä¹‰æ¶ˆæ¯ç±»å‹,è¿™é‡Œè®°å½•ä¸€ä¸‹è‡ªå®šä¹‰æ¶ˆæ¯ç±»å‹çš„è¿‡ç¨‹.</p>\n<p>ä½¿ç”¨çš„å·¥å…·å¦‚ä¸‹</p>\n<ul>\n<li>ROS2 Humble</li>\n<li>VSCode</li>\n<li>Alphapose</li>\n</ul>\n<p>ä¹‹å‰è·Ÿç€å®˜æ–¹æ–‡æ¡£åšè¿‡ä¸€æ¬¡,ä½†æ˜¯å­¦ä¼šäº†,ä½†åˆæ²¡å­¦ä¼š.è¿™æ¬¡æ˜¯çœŸçš„è¦ç”¨,åè€Œå‡ºé—®é¢˜äº†.</p>\n<h2 id=\"è‡ªå®šä¹‰æ¶ˆæ¯ç±»å‹\"><a href=\"#è‡ªå®šä¹‰æ¶ˆæ¯ç±»å‹\" class=\"headerlink\" title=\"è‡ªå®šä¹‰æ¶ˆæ¯ç±»å‹\"></a>è‡ªå®šä¹‰æ¶ˆæ¯ç±»å‹</h2><p>ä¹‹å‰ä»¥ä¸ºæ¯ä¸ªåŒ…é‡Œé¢éƒ½å¯ä»¥è‡ªå®šä¹‰æ¶ˆæ¯,ä½†æ˜¯æƒ³å¤šäº†,éœ€è¦ç‹¬ç«‹çš„åŒ…æ¥å­˜æ”¾è‡ªå®šä¹‰æ¶ˆæ¯.</p>\n<h3 id=\"åˆ›å»ºåŒ…\"><a href=\"#åˆ›å»ºåŒ…\" class=\"headerlink\" title=\"åˆ›å»ºåŒ…\"></a>åˆ›å»ºåŒ…</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ros2 pkg create --build-type ament_python --node-name people_msgs people_msgs</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"åˆ›å»ºæ¶ˆæ¯\"><a href=\"#åˆ›å»ºæ¶ˆæ¯\" class=\"headerlink\" title=\"åˆ›å»ºæ¶ˆæ¯\"></a>åˆ›å»ºæ¶ˆæ¯</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Point.msg</span></span><br><span class=\"line\">float32 x</span><br><span class=\"line\">float32 y</span><br><span class=\"line\">float32 z</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># People.msg ä»¥ä¸ºäººä½“å…³é”®ç‚¹æ˜¯26ä¸ª,æ‰€ä»¥è¿™é‡Œå°±å†™26ä¸ª,ä½†æ˜¯åé¢å‘ç°å‡ºäº†é—®é¢˜</span></span><br><span class=\"line\">Point[26] keypoints</span><br></pre></td></tr></table></figure>\n<p>è®°ä½è¿™ä¸ª26,é—®é¢˜å°±å‡ºåœ¨è¿™é‡Œ.</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># PeopleArray.msg</span></span><br><span class=\"line\">People[] people</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"ç¼–è¯‘\"><a href=\"#ç¼–è¯‘\" class=\"headerlink\" title=\"ç¼–è¯‘\"></a>ç¼–è¯‘</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">colcon build --packages-select people_msgs</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"ä½¿ç”¨\"><a href=\"#ä½¿ç”¨\" class=\"headerlink\" title=\"ä½¿ç”¨\"></a>ä½¿ç”¨</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">source</span> install/setup.bash</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"ä½¿ç”¨è‡ªå®šä¹‰æ¶ˆæ¯\"><a href=\"#ä½¿ç”¨è‡ªå®šä¹‰æ¶ˆæ¯\" class=\"headerlink\" title=\"ä½¿ç”¨è‡ªå®šä¹‰æ¶ˆæ¯\"></a>ä½¿ç”¨è‡ªå®šä¹‰æ¶ˆæ¯</h2><h3 id=\"åˆ›å»ºåŒ…-1\"><a href=\"#åˆ›å»ºåŒ…-1\" class=\"headerlink\" title=\"åˆ›å»ºåŒ…\"></a>åˆ›å»ºåŒ…</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ros2 pkg create --build-type ament_python --node-name people_sub people_sub</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"ç¼–å†™ä»£ç \"><a href=\"#ç¼–å†™ä»£ç \" class=\"headerlink\" title=\"ç¼–å†™ä»£ç \"></a>ç¼–å†™ä»£ç </h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># people_sub.py</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> rclpy</span><br><span class=\"line\"><span class=\"keyword\">from</span> rclpy.node <span class=\"keyword\">import</span> Node</span><br><span class=\"line\"><span class=\"keyword\">from</span> people_msgs.msg <span class=\"keyword\">import</span> PeopleArray</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">PeopleSub</span>(<span class=\"title class_ inherited__\">Node</span>):</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self</span>):</span><br><span class=\"line\">        <span class=\"built_in\">super</span>().__init__(<span class=\"string\">&#x27;people_sub&#x27;</span>)</span><br><span class=\"line\">        self.sub = self.create_subscription(PeopleArray, <span class=\"string\">&#x27;people&#x27;</span>, self.people_callback, <span class=\"number\">10</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">people_callback</span>(<span class=\"params\">self, msg</span>):</span><br><span class=\"line\">        self.get_logger().info(<span class=\"string\">&#x27;I heard: %s&#x27;</span> % msg)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">getnode</span>(<span class=\"params\">self</span>): <span class=\"comment\"># å‡å¦‚è¯´è¿™æ˜¯è¯†åˆ«åå¤„ç†å…³é”®ç‚¹çš„å‡½æ•°</span></span><br><span class=\"line\">        peoplearray = PeopleArray()</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> peoplelist: <span class=\"comment\"># å‡å¦‚è¯´è¿™æ˜¯è¯†åˆ«åæ‰€æœ‰äººçš„åˆ—è¡¨</span></span><br><span class=\"line\">            people = People()</span><br><span class=\"line\">            <span class=\"comment\"># people.keypoints.clear() # è¿™é‡Œæ˜¯å…³é”®,ä¸ç„¶ä¼šå‡ºé—®é¢˜</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> i: <span class=\"comment\">#æ¯ä¸ªäººèº«ä¸Šçš„å…³é”®ç‚¹</span></span><br><span class=\"line\">                point = Point()</span><br><span class=\"line\">                point.x = j[<span class=\"number\">0</span>]</span><br><span class=\"line\">                point.y = j[<span class=\"number\">1</span>]</span><br><span class=\"line\">                point.z = j[<span class=\"number\">2</span>]</span><br><span class=\"line\">                people.keypoints.append(point)</span><br><span class=\"line\">            peoplearray.people.append(people)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> peoplearray</span><br><span class=\"line\">        </span><br><span class=\"line\">                </span><br><span class=\"line\">                </span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">return</span> self</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">main</span>(<span class=\"params\">args=<span class=\"literal\">None</span></span>):</span><br><span class=\"line\">    rclpy.init(args=args)</span><br><span class=\"line\">    people_sub = PeopleSub()</span><br><span class=\"line\">    rclpy.spin(people_sub)</span><br><span class=\"line\">    people_sub.destroy_node()</span><br><span class=\"line\">    rclpy.shutdown()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">&#x27;__main__&#x27;</span>:</span><br><span class=\"line\">    main()</span><br></pre></td></tr></table></figure>\n<h3 id=\"ç¼–è¯‘-1\"><a href=\"#ç¼–è¯‘-1\" class=\"headerlink\" title=\"ç¼–è¯‘\"></a>ç¼–è¯‘</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">colcon build --packages-select people_sub</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"ä½¿ç”¨-1\"><a href=\"#ä½¿ç”¨-1\" class=\"headerlink\" title=\"ä½¿ç”¨\"></a>ä½¿ç”¨</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">source</span> install/setup.bash</span><br><span class=\"line\">ros2 run people_sub people_sub</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"é—®é¢˜\"><a href=\"#é—®é¢˜\" class=\"headerlink\" title=\"é—®é¢˜\"></a>é—®é¢˜</h2><p>æˆ‘ä½¿ç”¨è‡ªå®šä¹‰æ¶ˆæ¯è¿›è¡Œæ¥æ”¶,å‘ç°æ¥æ”¶åˆ°çš„æ¶ˆæ¯æ˜¯ç©ºçš„,åæ¥å‘ç°æ˜¯å› ä¸ºæˆ‘åœ¨åˆ›å»ºæ¶ˆæ¯çš„æ—¶å€™,å®ƒä¼šé»˜è®¤åˆ›å»ºä¸€ä¸ªç©ºçš„æ¶ˆæ¯(26ä¸ªæ•°æ®éƒ½æ˜¯0),æ‰€ä»¥æˆ‘åœ¨åˆ›å»ºæ¶ˆæ¯çš„æ—¶å€™,éœ€è¦å…ˆæ¸…ç©ºæ¶ˆæ¯,ç„¶åå†æ·»åŠ æ•°æ®.</p>\n<h2 id=\"æ„Ÿæ‚Ÿ\"><a href=\"#æ„Ÿæ‚Ÿ\" class=\"headerlink\" title=\"æ„Ÿæ‚Ÿ\"></a>æ„Ÿæ‚Ÿ</h2><p>æœç„¶<em>å®è·µæ˜¯æ£€éªŒçœŸç†çš„å”¯ä¸€æ ‡å‡†</em></p>\n<p>è¿™æ¬¡çš„é—®é¢˜æ˜¯å•æ­¥è°ƒè¯•å‡ºæ¥çš„,è°ƒè¯•ä¹‹å‰å¤„ç†äº†pythonè·¯å¾„çš„é—®é¢˜,ä¸ç„¶æ— æ³•ä½¿ç”¨VSCodeè°ƒè¯•.</p>\n<h3 id=\"pythonæ‰©å±•è·¯å¾„é—®é¢˜\"><a href=\"#pythonæ‰©å±•è·¯å¾„é—®é¢˜\" class=\"headerlink\" title=\"pythonæ‰©å±•è·¯å¾„é—®é¢˜\"></a>pythonæ‰©å±•è·¯å¾„é—®é¢˜</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1.é€šè¿‡è„šæœ¬æŸ¥çœ‹pythonè·¯å¾„</span></span><br><span class=\"line\">python -c <span class=\"string\">&quot;import sys; print(sys.path)&quot;</span></span><br></pre></td></tr></table></figure>\n\n<p>è®¾ç½®ç¯å¢ƒvscodeè·¯å¾„</p>\n<p>Pythonæ‰©å±• è®¾ç½® -&gt; Pythoninterpreter Path -&gt; (&#x2F;usr&#x2F;bin&#x2F;python3)æ¢æˆä¸Šä¸€æ­¥çš„è·¯å¾„å³å¯è§£å†³</p>\n<p>è¿˜æœ‰ä¸ªé—®é¢˜æˆ‘é—®äº†ä¸‹GPT</p>\n<h3 id=\"ROS2ä½¿ç”¨è‡ªå®šä¹‰Pythonè§£é‡Šå™¨\"><a href=\"#ROS2ä½¿ç”¨è‡ªå®šä¹‰Pythonè§£é‡Šå™¨\" class=\"headerlink\" title=\"ROS2ä½¿ç”¨è‡ªå®šä¹‰Pythonè§£é‡Šå™¨\"></a>ROS2ä½¿ç”¨è‡ªå®šä¹‰Pythonè§£é‡Šå™¨</h3><p>è¦æŒ‡å®šROS 2ä½¿ç”¨çš„Pythonè§£é‡Šå™¨ï¼Œæ‚¨å¯ä»¥è®¾ç½®ç¯å¢ƒå˜é‡PYTHON_EXECUTABLEï¼Œå°†å…¶è®¾ç½®ä¸ºè¦ä½¿ç”¨çš„Pythonè§£é‡Šå™¨çš„è·¯å¾„ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æ‚¨çš„è‡ªå®šä¹‰Pythonè§£é‡Šå™¨ä½äº&#x2F;path&#x2F;to&#x2F;my&#x2F;pythonï¼Œåˆ™å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åœ¨ç»ˆç«¯ä¸­è®¾ç½®ç¯å¢ƒå˜é‡ï¼š</p>\n<p><code>export PYTHON_EXECUTABLE=/path/to/my/python</code></p>\n<p>è®¾ç½®ç¯å¢ƒå˜é‡åï¼ŒROS 2å°†ä½¿ç”¨æŒ‡å®šçš„Pythonè§£é‡Šå™¨ã€‚æ‚¨å¯ä»¥åœ¨å¯åŠ¨ROS 2èŠ‚ç‚¹æ—¶éªŒè¯Pythonè§£é‡Šå™¨æ˜¯å¦æ­£ç¡®è®¾ç½®ï¼Œä¾‹å¦‚ï¼š</p>\n<p><code>ros2 run my_package my_node --ros-args --log-level debug</code></p>\n<p>è¿™å°†åœ¨ç»ˆç«¯è¾“å‡ºROS 2èŠ‚ç‚¹çš„æ—¥å¿—ä¿¡æ¯ï¼Œå…¶ä¸­åŒ…æ‹¬ä½¿ç”¨çš„Pythonè§£é‡Šå™¨ã€‚å¦‚æœæ‚¨çœ‹åˆ°çš„è¾“å‡ºä¸­åŒ…å«æ‚¨è‡ªå®šä¹‰çš„Pythonè§£é‡Šå™¨è·¯å¾„ï¼Œåˆ™è¡¨ç¤ºROS 2æ­£åœ¨ä½¿ç”¨æŒ‡å®šçš„Pythonè§£é‡Šå™¨ã€‚</p>\n<p>æ³¨æ„ï¼Œè®¾ç½®è‡ªå®šä¹‰Pythonè§£é‡Šå™¨å¯èƒ½ä¼šå¯¼è‡´ROS 2æŸäº›åŠŸèƒ½æ— æ³•æ­£å¸¸å·¥ä½œï¼Œå› ä¸ºROS 2å¯èƒ½ä¾èµ–äºç‰¹å®šç‰ˆæœ¬çš„Pythonå’ŒPythonåº“ã€‚å¦‚æœæ‚¨é‡åˆ°é—®é¢˜ï¼Œè¯·å°è¯•ä½¿ç”¨ROS 2é»˜è®¤çš„Pythonè§£é‡Šå™¨ï¼Œæˆ–è€…ç¡®ä¿æ‚¨çš„è‡ªå®šä¹‰Pythonè§£é‡Šå™¨ä¸ROS 2æ‰€éœ€çš„Pythonç‰ˆæœ¬å’Œåº“å…¼å®¹ã€‚</p>\n","categories":[],"tags":[{"name":"ğŸ¦¾ROS2","path":"api/tags/ğŸ¦¾ROS2.json"}]}
{"title":"三根杆","slug":"code/三自由度","date":"2022-01-03T13:20:55.000Z","updated":"2023-07-05T13:50:43.978Z","comments":true,"path":"api/articles/code/三自由度.json","excerpt":null,"covers":["https://img.undf.top/index/2021-12-21-17-53-30.gif","https://img.undf.top/image/%E4%B8%89%E8%87%AA%E7%94%B1%E5%BA%A6/2022-01-03-10-38-07.png","https://img.undf.top/image/%E4%B8%89%E8%87%AA%E7%94%B1%E5%BA%A6/2022-01-03-10-41-42.png","https://img.undf.top/image/%E4%B8%89%E8%87%AA%E7%94%B1%E5%BA%A6/2022-01-03-10-46-00.png","https://img.undf.top/image/%E4%B8%89%E8%87%AA%E7%94%B1%E5%BA%A6/2022-01-03-10-51-13.png","https://img.undf.top/image/%E4%B8%89%E8%87%AA%E7%94%B1%E5%BA%A6/2022-01-03-10-51-13.png","https://img.undf.top/image/%E4%B8%89%E8%87%AA%E7%94%B1%E5%BA%A6/2022-01-03-12-05-57.png","https://img.undf.top/index/2021-12-21-17-53-30.gif"],"content":"<h2 id=\"初\"><a href=\"#初\" class=\"headerlink\" title=\"初\"></a>初</h2><p>机械手臂（英语：robotic arm）是具有模仿人类手臂功能并可完成各种作业的自动控制设备，这种机器人系统有多关节连结并节允许在平面或三度空间进行运动或使用线性位移移动。</p>\n<p>本文的主题是平面三轴机械臂。</p>\n<p><img src=\"https://img.undf.top/index/2021-12-21-17-53-30.gif\" alt=\"TU\"></p>\n<h2 id=\"启\"><a href=\"#启\" class=\"headerlink\" title=\"启\"></a>启</h2><p>首先来学习一下单轴的，如下图：</p>\n<p><img src=\"https://img.undf.top/image/%E4%B8%89%E8%87%AA%E7%94%B1%E5%BA%A6/2022-01-03-10-38-07.png\" alt=\"2022-01-03-10-38-07\"><br>（系统画图画的）</p>\n<p>将物理问题转化为数学问题，建立坐标系：</p>\n<p><img src=\"https://img.undf.top/image/%E4%B8%89%E8%87%AA%E7%94%B1%E5%BA%A6/2022-01-03-10-41-42.png\" alt=\"2022-01-03-10-41-42\"></p>\n<p>杆长取<code>r</code>很容易就能得到端点坐标为<code>rcosα,rscinα</code></p>\n<p>是不是很简单，那接下来看两个杆。</p>\n<h2 id=\"中\"><a href=\"#中\" class=\"headerlink\" title=\"中\"></a>中</h2><p>如图所示<br><img src=\"https://img.undf.top/image/%E4%B8%89%E8%87%AA%E7%94%B1%E5%BA%A6/2022-01-03-10-46-00.png\" alt=\"2022-01-03-10-46-00\"></p>\n<p>继续将物理问题转化为数学问题，建立坐标系：</p>\n<p><img src=\"https://img.undf.top/image/%E4%B8%89%E8%87%AA%E7%94%B1%E5%BA%A6/2022-01-03-10-51-13.png\" alt=\"2022-01-03-10-51-13\"></p>\n<p>这里我作了两条辅助线用来辅助理解</p>\n<p>图中α，β为绝对角度（也就是相对于x轴的角度），θ1，2，是相对角度（相对于上一段的角度）他的值可能为正也可能为负值，这样我们就能得到α，β与θ的表达式<code>α=θ1，β=θ1+θ2</code></p>\n<p>杆长依旧取<code>r</code>，为了便于说明这里三根杆的长度都取<code>r</code>这里我们很容易就能得到最右端坐标的表达式为：<code>rcosα+rcosβ,rscinα+rsinβ</code></p>\n<p>同理我们可以得到三杆的表达式<code>α=θ1，β=θ1+θ2，γ=θ1+θ2+θ3</code>和<code>rcosα+rcosβ+rcosγ,rscinα+rsinβ+rsinγ</code></p>\n<p>到这里你肯定觉得这好简单，为什么要写一篇文章讲这个？</p>\n<blockquote>\n<p>上述思路皆为正运动学（正运动学可以大致理解为已知三根杆的长度和角度，求端点坐标）。<br>既然有正运动学，就会有逆运动学（逆运动学可以理解为已知三杆长度和端点坐标，求相关角度）。<br>而在实际运用中，逆运动学往往更多，比如抓取物体。</p>\n</blockquote>\n<h2 id=\"潮\"><a href=\"#潮\" class=\"headerlink\" title=\"潮\"></a>潮</h2><p>咱们还是从简单的开始</p>\n<p>杆长<code>r</code>，端点坐标为<code>x,y</code>，很容易就能得到α角度<code>arccos(r/x),arcsin(r/y)</code></p>\n<p>接下来看两杆</p>\n<p><img src=\"https://img.undf.top/image/%E4%B8%89%E8%87%AA%E7%94%B1%E5%BA%A6/2022-01-03-10-51-13.png\" alt=\"2022-01-03-10-51-13\"></p>\n<p>依旧看这幅图，很容易就能想到余弦定理求角度，这没问题，但你可能会遇到一个问题，如图</p>\n<p><img src=\"https://img.undf.top/image/%E4%B8%89%E8%87%AA%E7%94%B1%E5%BA%A6/2022-01-03-12-05-57.png\" alt=\"2022-01-03-12-05-57\"></p>\n<p>你得到的结果可能是两个，这个时候就需要添加条件排除掉其中一个，或者根据条件选取最合适的一个，比如说让相对角度尽可能小，这样可以减少电机转动的圈数。</p>\n<p>两杆就开始有多解，那三杆呢，肯定会有更多解，这个时候就要根据项目的具体情况去添加限制条件，下面拿具体项目来讲讲。</p>\n<p><strong>题目：使用摄像头进行识别并抓取物块放到指定的位置</strong></p>\n<p>这里是三个杆，就要想办法增加条件限制解的个数，比如物体的姿态，机械爪需要从哪个角度抓取等等条件。</p>\n<p>我这里增加的就是物体姿态角，通过姿态角将三杆问题转化为两杆，再增加相对角度之和最小的条件得到最终结果。</p>\n<p>如图所示：</p>\n<p><img src=\"https://img.undf.top/index/2021-12-21-17-53-30.gif\" alt=\"动图\"></p>\n<p>下面详细介绍具体过程和代码实现（MFC &amp; C++）</p>\n<ol>\n<li>求解<br>根据坐标和姿态计算角度</li>\n<li>移动到合适的抓取姿态<br>依次转动三根杆到合适的角度（也可以同时转动）</li>\n<li>抓取<br>进行抓取</li>\n</ol>\n<p>在这三个过程中还要通过正运动学计算并绘制爪子<br>另外，计算机的坐标原点和xy轴都在左上角，并不是中心点，需要进行坐标系变换，这里不再详细讲述。</p>\n<p>源码仓库<a href=\"https://github.com/wxydejoy/DrawPath/\">GitHub - wxydejoy&#x2F;DrawPath: 三杆 机械臂</a></p>\n<p>这里就不对代码进行介绍了，内容很多，核心部分以及思路已经在上述内容中讲过，欢迎指正。</p>\n<h2 id=\"终\"><a href=\"#终\" class=\"headerlink\" title=\"终\"></a>终</h2><p>思路其实不是很难，难的是其中的细节，敲错一点或者有理解不清楚的结果就会完全不一样。</p>\n<p>平面三杆已经有点复杂了，那如果是空间三杆呢？如何计算？</p>\n<h2 id=\"引\"><a href=\"#引\" class=\"headerlink\" title=\"引\"></a>引</h2><p><a href=\"https://zh.wikipedia.org/wiki/%E6%A9%9F%E6%A2%B0%E6%89%8B%E8%87%82\">機械手臂 - 维基百科，自由的百科全书</a></p>\n","more":"<h2 id=\"初\"><a href=\"#初\" class=\"headerlink\" title=\"初\"></a>初</h2><p>机械手臂（英语：robotic arm）是具有模仿人类手臂功能并可完成各种作业的自动控制设备，这种机器人系统有多关节连结并节允许在平面或三度空间进行运动或使用线性位移移动。</p>\n<p>本文的主题是平面三轴机械臂。</p>\n<p><img src=\"https://img.undf.top/index/2021-12-21-17-53-30.gif\" alt=\"TU\"></p>\n<h2 id=\"启\"><a href=\"#启\" class=\"headerlink\" title=\"启\"></a>启</h2><p>首先来学习一下单轴的，如下图：</p>\n<p><img src=\"https://img.undf.top/image/%E4%B8%89%E8%87%AA%E7%94%B1%E5%BA%A6/2022-01-03-10-38-07.png\" alt=\"2022-01-03-10-38-07\"><br>（系统画图画的）</p>\n<p>将物理问题转化为数学问题，建立坐标系：</p>\n<p><img src=\"https://img.undf.top/image/%E4%B8%89%E8%87%AA%E7%94%B1%E5%BA%A6/2022-01-03-10-41-42.png\" alt=\"2022-01-03-10-41-42\"></p>\n<p>杆长取<code>r</code>很容易就能得到端点坐标为<code>rcosα,rscinα</code></p>\n<p>是不是很简单，那接下来看两个杆。</p>\n<h2 id=\"中\"><a href=\"#中\" class=\"headerlink\" title=\"中\"></a>中</h2><p>如图所示<br><img src=\"https://img.undf.top/image/%E4%B8%89%E8%87%AA%E7%94%B1%E5%BA%A6/2022-01-03-10-46-00.png\" alt=\"2022-01-03-10-46-00\"></p>\n<p>继续将物理问题转化为数学问题，建立坐标系：</p>\n<p><img src=\"https://img.undf.top/image/%E4%B8%89%E8%87%AA%E7%94%B1%E5%BA%A6/2022-01-03-10-51-13.png\" alt=\"2022-01-03-10-51-13\"></p>\n<p>这里我作了两条辅助线用来辅助理解</p>\n<p>图中α，β为绝对角度（也就是相对于x轴的角度），θ1，2，是相对角度（相对于上一段的角度）他的值可能为正也可能为负值，这样我们就能得到α，β与θ的表达式<code>α=θ1，β=θ1+θ2</code></p>\n<p>杆长依旧取<code>r</code>，为了便于说明这里三根杆的长度都取<code>r</code>这里我们很容易就能得到最右端坐标的表达式为：<code>rcosα+rcosβ,rscinα+rsinβ</code></p>\n<p>同理我们可以得到三杆的表达式<code>α=θ1，β=θ1+θ2，γ=θ1+θ2+θ3</code>和<code>rcosα+rcosβ+rcosγ,rscinα+rsinβ+rsinγ</code></p>\n<p>到这里你肯定觉得这好简单，为什么要写一篇文章讲这个？</p>\n<blockquote>\n<p>上述思路皆为正运动学（正运动学可以大致理解为已知三根杆的长度和角度，求端点坐标）。<br>既然有正运动学，就会有逆运动学（逆运动学可以理解为已知三杆长度和端点坐标，求相关角度）。<br>而在实际运用中，逆运动学往往更多，比如抓取物体。</p>\n</blockquote>\n<h2 id=\"潮\"><a href=\"#潮\" class=\"headerlink\" title=\"潮\"></a>潮</h2><p>咱们还是从简单的开始</p>\n<p>杆长<code>r</code>，端点坐标为<code>x,y</code>，很容易就能得到α角度<code>arccos(r/x),arcsin(r/y)</code></p>\n<p>接下来看两杆</p>\n<p><img src=\"https://img.undf.top/image/%E4%B8%89%E8%87%AA%E7%94%B1%E5%BA%A6/2022-01-03-10-51-13.png\" alt=\"2022-01-03-10-51-13\"></p>\n<p>依旧看这幅图，很容易就能想到余弦定理求角度，这没问题，但你可能会遇到一个问题，如图</p>\n<p><img src=\"https://img.undf.top/image/%E4%B8%89%E8%87%AA%E7%94%B1%E5%BA%A6/2022-01-03-12-05-57.png\" alt=\"2022-01-03-12-05-57\"></p>\n<p>你得到的结果可能是两个，这个时候就需要添加条件排除掉其中一个，或者根据条件选取最合适的一个，比如说让相对角度尽可能小，这样可以减少电机转动的圈数。</p>\n<p>两杆就开始有多解，那三杆呢，肯定会有更多解，这个时候就要根据项目的具体情况去添加限制条件，下面拿具体项目来讲讲。</p>\n<p><strong>题目：使用摄像头进行识别并抓取物块放到指定的位置</strong></p>\n<p>这里是三个杆，就要想办法增加条件限制解的个数，比如物体的姿态，机械爪需要从哪个角度抓取等等条件。</p>\n<p>我这里增加的就是物体姿态角，通过姿态角将三杆问题转化为两杆，再增加相对角度之和最小的条件得到最终结果。</p>\n<p>如图所示：</p>\n<p><img src=\"https://img.undf.top/index/2021-12-21-17-53-30.gif\" alt=\"动图\"></p>\n<p>下面详细介绍具体过程和代码实现（MFC &amp; C++）</p>\n<ol>\n<li>求解<br>根据坐标和姿态计算角度</li>\n<li>移动到合适的抓取姿态<br>依次转动三根杆到合适的角度（也可以同时转动）</li>\n<li>抓取<br>进行抓取</li>\n</ol>\n<p>在这三个过程中还要通过正运动学计算并绘制爪子<br>另外，计算机的坐标原点和xy轴都在左上角，并不是中心点，需要进行坐标系变换，这里不再详细讲述。</p>\n<p>源码仓库<a href=\"https://github.com/wxydejoy/DrawPath/\">GitHub - wxydejoy&#x2F;DrawPath: 三杆 机械臂</a></p>\n<p>这里就不对代码进行介绍了，内容很多，核心部分以及思路已经在上述内容中讲过，欢迎指正。</p>\n<h2 id=\"终\"><a href=\"#终\" class=\"headerlink\" title=\"终\"></a>终</h2><p>思路其实不是很难，难的是其中的细节，敲错一点或者有理解不清楚的结果就会完全不一样。</p>\n<p>平面三杆已经有点复杂了，那如果是空间三杆呢？如何计算？</p>\n<h2 id=\"引\"><a href=\"#引\" class=\"headerlink\" title=\"引\"></a>引</h2><p><a href=\"https://zh.wikipedia.org/wiki/%E6%A9%9F%E6%A2%B0%E6%89%8B%E8%87%82\">機械手臂 - 维基百科，自由的百科全书</a></p>\n","categories":[{"name":"💻Code","path":"api/categories/💻Code.json"}],"tags":[{"name":"⚙️Machine","path":"api/tags/⚙️Machine.json"},{"name":"🦾平面三杆","path":"api/tags/🦾平面三杆.json"}]}